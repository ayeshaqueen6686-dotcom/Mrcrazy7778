<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Crazy App - MrCrazyTeam</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

  <style>
  
    :root {
      --primary: #6a4cff;
      --dark: #0f0f1e;
      --gray: #1e1e2e;
      --light: #f0f0ff;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a0033 0%, #2d0055 100%);
      min-height: 100vh;
      color: white;
    }

    /* PlayStore Style App Cards - Full Description */
    .app-card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 18px;
      margin-bottom: 18px;
      transition: all 0.4s ease;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    .app-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(106, 76, 255, 0.4);
      background: rgba(255,255,255,0.15);
    }

    .app-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 12px;
    }

    .app-icon {
      width: 80px;
      height: 80px;
      border-radius: 16px;
      object-fit: cover;
      border: 3px solid var(--primary);
      box-shadow: 0 8px 20px rgba(106,76,255,0.4);
    }

    .app-title-info {
      flex: 1;
    }

    .app-name {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .app-dev {
      font-size: 14px;
      opacity: 0.8;
      margin-bottom: 6px;
    }

    .app-size {
      font-size: 13px;
      opacity: 0.7;
    }

    .app-desc {
      font-size: 15px;
      line-height: 1.6;
      margin: 12px 0;
      opacity: 0.9;
      white-space: pre-wrap;
    }

    .app-stats {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      font-size: 14px;
      opacity: 0.8;
    }

    .download-btn {
      background: var(--primary);
      padding: 12px 30px;
      border-radius: 30px;
      font-weight: bold;
      transition: 0.3s;
    }

    .download-btn:hover {
      background: #5a3dff;
      transform: scale(1.08);
    }

    /* Group Updates Card */
    .update-card {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 18px;
      margin-bottom: 18px;
      transition: 0.3s;
      border-left: 5px solid var(--primary);
    }

    .update-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(106,76,255,0.3);
    }

    .update-text {
      font-size: 16px;
      line-height: 1.6;
      margin-bottom: 15px;
      white-space: pre-wrap;
    }

    .update-meta {
      font-size: 13px;
      opacity: 0.7;
      margin-bottom: 15px;
    }

    .reactions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .reaction-btn {
      background: rgba(255,255,255,0.15);
      padding: 8px 16px;
      border-radius: 30px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: 0.3s;
      font-size: 14px;
    }

    .reaction-btn:hover {
      background: rgba(255,255,255,0.3);
      transform: scale(1.05);
    }
/* Status Colors - Enhanced for Complaints History */
.status {
  font-size: 12px;
  padding: 8px 15px;
  border-radius: 20px;
  display: inline-block;
  margin: 10px 0;
  font-weight: bold;
  text-transform: uppercase;
  transition: 0.3s;
}

.status.pending { background: #ff8800; color: white; }
.status.processing { background: #4488ff; color: white; } /* Blue */
.status.approved { background: #00aa55; color: white; } /* Green */
.status.rejected { background: #aa0000; color: white; } /* Red */

/* Complaint History Card - Slim Style */
.complaint-card {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 18px;
  margin-bottom: 15px;
  border-left: 5px solid var(--primary);
  transition: 0.3s;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.complaint-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 30px rgba(123,44,255,0.3);
}
/* SIM Details Request - Premium Ramzan VIP Style */
#simDetailsPage {
  background: rgba(11, 31, 33, 0.96);
  backdrop-filter: blur(20px);
  border: 1.8px solid rgba(201, 162, 39, 0.4);
  border-radius: 26px;
  padding: 24px;
  box-shadow: 0 10px 35px rgba(201, 162, 39, 0.25);
  position: relative;
  overflow: hidden;
}

#simDetailsPage::before {
  content: '☾';
  position: absolute;
  top: 15px;
  right: 20px;
  font-size: 60px;
  color: rgba(255, 248, 231, 0.18);
  z-index: 0;
  animation: chandPulse 12s ease-in-out infinite;
}

/* Greeting Section - Glow Effect */
#simDetailsPage .greeting-box {
  background: linear-gradient(135deg, rgba(201, 162, 39, 0.12), rgba(10, 92, 78, 0.08));
  border-radius: 20px;
  padding: 25px 20px;
  margin: 20px 0 30px;
  border: 1.5px solid rgba(201, 162, 39, 0.35);
  text-align: center;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
  position: relative;
  z-index: 1;
}

#simDetailsPage h2 {
  font-size: 26px;
  color: var(--ramzan-gold);
  margin-bottom: 12px;
  text-shadow: 0 0 15px rgba(201, 162, 39, 0.6);
  font-weight: bold;
  letter-spacing: 1px;
}

#simDetailsPage p {
  font-size: 16px;
  color: var(--ramzan-cream);
  opacity: 0.95;
  line-height: 1.6;
}

/* Input Fields - Elegant Style */
#simDetailsPage input,
#simDetailsPage textarea {
  background: rgba(255, 248, 231, 0.08);
  border: 1.8px solid rgba(201, 162, 39, 0.4);
  border-radius: 18px;
  padding: 16px 18px;
  color: var(--ramzan-cream);
  font-size: 16px;
  width: 100%;
  margin: 12px 0;
  transition: all 0.3s ease;
  font-family: 'Amiri', serif;
}

#simDetailsPage input:focus,
#simDetailsPage textarea:focus {
  border-color: var(--ramzan-gold);
  box-shadow: 0 0 20px rgba(201, 162, 39, 0.35);
  background: rgba(255, 248, 231, 0.12);
  outline: none;
}

#simDetailsPage input::placeholder,
#simDetailsPage textarea::placeholder {
  color: rgba(255, 248, 231, 0.5);
}

/* Submit Button - Gold Glow */
#simDetailsPage button {
  background: linear-gradient(135deg, var(--ramzan-gold), #b5892e);
  color: var(--ramzan-dark);
  border: none;
  border-radius: 50px;
  padding: 16px;
  font-size: 18px;
  font-weight: bold;
  width: 100%;
  margin: 20px 0 10px;
  cursor: pointer;
  box-shadow: 0 8px 25px rgba(201, 162, 39, 0.5);
  transition: all 0.4s ease;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  position: relative;
  overflow: hidden;
  z-index: 1;
}

#simDetailsPage button:hover {
  transform: translateY(-4px);
  box-shadow: 0 15px 40px rgba(201, 162, 39, 0.7);
}

#simDetailsPage button::after {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 60%);
  opacity: 0;
  transition: opacity 0.6s;
}

#simDetailsPage button:hover::after {
  opacity: 1;
}
/* Small Green WhatsApp Floating Button - Clean & Animated */
#whatsappFloatBtn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 55px;
  height: 55px;
  background: #25D366;
  border-radius: 50%;
  box-shadow: 0 6px 15px rgba(37, 213, 102, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  text-decoration: none;
  transition: all 0.4s ease;
  animation: waFloat 3s infinite ease-in-out;
}

#whatsappFloatBtn:hover {
  transform: scale(1.15);
  box-shadow: 0 10px 25px rgba(37, 213, 102, 0.8);
  animation: none;
}

.wa-icon-container {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.wa-icon {
  color: white;
  font-size: 20px;
  font-weight: bold;
  letter-spacing: 1px;
  text-shadow: 0 1px 3px rgba(0,0,0,0.4);
}

/* Light floating + pulse animation */
@keyframes waFloat {
  0%, 100% {
    transform: translateY(0);
    box-shadow: 0 6px 15px rgba(37,213,102,0.5);
  }
  50% {
    transform: translateY(-8px);
    box-shadow: 0 12px 25px rgba(37,213,102,0.7);
  }
}

/* Mobile pe chhota adjust */
@media (max-width: 480px) {
  #whatsappFloatBtn {
    bottom: 15px;
    right: 15px;
    width: 50px;
    height: 50px;
  }
  .wa-icon {
    font-size: 18px;
  }
}
/* Result Message */
#simResult {
  margin-top: 25px;
  padding: 20px;
  border-radius: 16px;
  background: rgba(0, 204, 136, 0.15);
  border-left: 5px solid #00cc88;
  color: var(--ramzan-cream);
  font-size: 16px;
  line-height: 1.6;
}

#simResult.error {
  background: rgba(255, 68, 68, 0.15);
  border-left-color: #ff4444;
}

/* Back Link */
#simDetailsPage .link {
  text-align: center;
  margin-top: 30px;
  color: var(--ramzan-gold);
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s;
}

#simDetailsPage .link:hover {
  color: #fff;
  text-shadow: 0 0 10px rgba(201, 162, 39, 0.6);
}

/* Mobile Adjustments */
@media (max-width: 480px) {
  #simDetailsPage {
    padding: 18px;
  }
  
  #simDetailsPage h1 {
    font-size: 26px;
  }
  
  #simDetailsPage h2 {
    font-size: 22px;
  }
  
  #simDetailsPage button {
    padding: 15px;
    font-size: 16px;
  }
}
.complaint-id { font-size: 14px; opacity: 0.8; margin-bottom: 5px; }
.complaint-time { font-size: 12px; opacity: 0.7; text-align: right; margin-bottom: 10px; }
.complaint-issue { font-size: 15px; line-height: 1.6; margin-bottom: 10px; }
.complaint-reply {
  background: rgba(0,204,136,0.2);
  padding: 12px;
  border-radius: 12px;
  margin: 10px 0;
  font-size: 14px;
  border-left: 4px solid #00cc88;
}

.complaint-reply.none { background: rgba(255,68,68,0.1); border-left-color: #ff4444; opacity: 0.7; }
    .reaction-btn.active {
      background: var(--primary);
    }

    .container {
      max-width: 480px;
      margin: 0 auto;
      padding: 15px;
      min-height: 100vh;
    }
    .card {
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(12px);
      border-radius: 18px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.4);
      animation: slideUp 0.6s ease-out;
    }
    @keyframes slideUp {
      from { opacity:0; transform:translateY(20px); }
      to { opacity:1; transform:translateY(0); }
    }

    h1 {
      text-align:center;
      font-size:24px;
      margin-bottom:20px;
      background: linear-gradient(45deg, #fff, #c0bfff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Notification Popups */
    .notification-popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      animation: fadeInPopup 0.5s ease;
    }

    @keyframes fadeInPopup {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .notification-content {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 30px;
      max-width: 90%;
      text-align: center;
      border: 2px solid var(--primary);
      box-shadow: 0 20px 50px rgba(106,76,255,0.5);
      position: relative;
    }

    .notification-content.emergency {
      border: 3px solid #ff4444;
      box-shadow: 0 20px 50px rgba(255,68,68,0.6);
    }

    .close-btn {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 32px;
      cursor: pointer;
      opacity: 0.8;
      transition: 0.3s;
    }

    .close-btn:hover {
      opacity: 1;
      transform: scale(1.2);
    }
    


/* Mobile Fix */
@media (max-width: 768px) {
  .powered-banner {
    bottom: 15px;
    padding: 12px 24px;
    font-size: 16px;
  }
  .glow-text {
    font-size: 20px;
  }
}
    #normalMessage {
      font-size: 20px;
      line-height: 1.6;
      margin: 20px 0;
    }

    #emergencyDownloadBtn {
      margin-top: 25px;
      padding: 16px 40px;
      background: #ff4444;
      color: white;
      border: none;
      border-radius: 16px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(255,68,68,0.4);
      transition: 0.3s;
    }

    #emergencyDownloadBtn:hover {
      background: #ff0000;
      transform: scale(1.05);
    }

    input, textarea {
      width:100%;
      padding:12px;
      margin:8px 0;
      border:none;
      border-radius:10px;
      background:rgba(255,255,255,0.1);
      color:white;
      font-size:15px;
    }
    input::placeholder, textarea::placeholder { color:rgba(255,255,255,0.6); }
    button {
      width:100%;
      padding:12px;
      margin:10px 0;
      border:none;
      border-radius:10px;
      background: var(--primary);
      color:white;
      font-weight:bold;
      cursor:pointer;
      transition:0.3s;
    }
    button:hover { transform:scale(1.02); }
    .small-btn {
      background:rgba(255,255,255,0.1);
      margin:5px 0;
      text-align:left;
      padding-left:15px;
    }/* Entertainment Chat - Cool & Professional Look */
.entertainment-container {
  height: 55vh;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 15px;
  background: rgba(255,255,255,0.05);
  border-radius: 16px;
  margin-bottom: 15px;
  scrollbar-width: thin;
  scrollbar-color: var(--primary) transparent;
}

.entertainment-msg {
  max-width: 80%;
  padding: 14px 20px;
  border-radius: 22px;
  background: rgba(255,255,255,0.12);
  backdrop-filter: blur(10px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  transition: transform 0.2s;
}
/* About & Trust Page - Clean & Professional */
.trust-container {
  display: grid;
  gap: 20px;
  margin: 20px 0;
}

.trust-item {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(15px);
  border-radius: 20px;
  padding: 22px;
  text-align: center;
  border: 1px solid rgba(123,44,255,0.3);
  transition: 0.4s;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

.trust-item:hover {
  transform: translateY(-8px);
  box-shadow: 0 15px 40px rgba(123,44,255,0.4);
  border-color: var(--primary);
}

.trust-icon {
  font-size: 48px;
  margin-bottom: 15px;
}

.trust-title {
  font-size: 20px;
  font-weight: 700;
  background: linear-gradient(45deg, #7b2cff, #00d4ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 12px;
}

.trust-desc {
  font-size: 15px;
  opacity: 0.9;
  line-height: 1.6;
}

.trust-footer {
  text-align: center;
  margin: 40px 0 20px;
  padding: 20px;
  background: rgba(123,44,255,0.15);
  border-radius: 20px;
  border: 1px dashed rgba(123,44,255,0.4);
}
/* Apps List - Grid Style */
#appsList {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 18px;
  margin: 20px 0;
}

.app-box {
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(12px);
  border-radius: 18px;
  padding: 16px;
  text-align: center;
  cursor: pointer;
  transition: 0.4s;
  border: 1px solid rgba(106,76,255,0.3);
}

.app-box:hover {
  transform: translateY(-8px);
  box-shadow: 0 15px 35px rgba(106,76,255,0.4);
  border-color: var(--primary);
}

.app-box img {
  width: 70px;
  height: 70px;
  border-radius: 16px;
  object-fit: cover;
  border: 3px solid var(--primary);
  margin-bottom: 10px;
}

.app-box .name {
  font-weight: bold;
  font-size: 15px;
  margin-bottom: 4px;
}

.app-box .dev {
  font-size: 13px;
  opacity: 0.8;
}

/* Modal */
.modal {
  position: fixed;
  top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.9);
  backdrop-filter: blur(10px);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
}

.modal-content {
  background: rgba(20,18,38,0.98);
  border-radius: 24px;
  padding: 30px;
  max-width: 90%;
  text-align: center;
  border: 2px solid var(--primary);
  box-shadow: 0 20px 50px rgba(106,76,255,0.6);
}

.close-modal {
  position: absolute;
  top: 15px;
  right: 20px;
  font-size: 35px;
  cursor: pointer;
  color: #ff4444;
}

.app-detail-icon {
  width: 120px;
  height: 120px;
  border-radius: 24px;
  border: 5px solid var(--primary);
  margin-bottom: 20px;
}

.app-detail-name {
  font-size: 26px;
  font-weight: bold;
  margin-bottom: 10px;
}

.app-detail-dev {
  font-size: 18px;
  opacity: 0.9;
  margin-bottom: 15px;
}

.app-detail-desc {
  font-size: 16px;
  line-height: 1.7;
  margin: 20px 0;
  padding: 15px;
  background: rgba(255,255,255,0.05);
  border-radius: 16px;
}

.download-big-btn {
  background: linear-gradient(135deg, #00cc88, #00aa66);
  padding: 18px 50px;
  border-radius: 50px;
  font-size: 20px;
  font-weight: bold;
  color: white;
  text-decoration: none;
  display: inline-block;
  margin-top: 20px;
  box-shadow: 0 10px 30px rgba(0,204,136,0.5);
}

.download-big-btn:hover {
  transform: scale(1.05);
}
.trust-footer p {
  opacity: 0.8;
  font-size: 16px;
}

.trust-footer h3 {
  font-size: 28px;
  background: linear-gradient(90deg, #7b2cff, #00d4ff, #ff4444);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 800;
  margin-top: 8px;
}
.entertainment-msg:hover {
  transform: translateY(-2px);
}

.entertainment-msg.own {
  align-self: flex-end;
  background: linear-gradient(135deg, #7b2cff, #9d59ff);
  color: white;
}

.entertainment-msg-header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 8px;
}

.entertainment-msg-pic {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  object-fit: cover;
  border: 3px solid var(--primary);
  box-shadow: 0 4px 10px rgba(123,44,255,0.4);
}

.entertainment-msg-username {
  font-weight: 600;
  font-size: 15px;
  color: #e0e0ff;
}

.entertainment-msg-text {
  font-size: 16px;
  line-height: 1.5;
  margin-bottom: 8px;
}

.entertainment-msg img {
  max-width: 240px;
  border-radius: 16px;
  margin-top: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

.entertainment-msg-time {
  font-size: 11px;
  opacity: 0.7;
  text-align: right;
}

.entertainment-reactions {
  display: flex;
  gap: 10px;
  margin-top: 10px;
  flex-wrap: wrap;
}

.entertainment-reaction {
  background: rgba(255,255,255,0.2);
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 14px;
  cursor: pointer;
  transition: 0.3s;
  backdrop-filter: blur(5px);
}

.entertainment-reaction:hover {
  background: rgba(255,255,255,0.4);
  transform: scale(1.1);
}

.entertainment-reply {
  margin-left: 50px;
  margin-top: 12px;
  padding: 12px;
  background: rgba(255,255,255,0.08);
  border-radius: 18px;
  border-left: 4px solid var(--primary);
  font-size: 15px;
}
/* User Movie & Drama History - Slim Ramzan VIP (User-Only) */
.history-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin: 15px 0;
  max-height: 60vh;
  overflow-y: auto;
}

.history-item {
  background: rgba(11,31,33,0.95);
  backdrop-filter: blur(20px);
  border: 1.8px solid rgba(201,162,39,0.4);
  border-radius: 24px;
  padding: 16px;
  position: relative;
  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  font-family: 'Amiri', serif;
  transition: 0.3s;
}

.history-item:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 35px rgba(201,162,39,0.3);
}

.history-type {
  font-size: 16px;
  color: var(--ramzan-gold);
  font-weight: bold;
  margin-bottom: 6px;
}

.history-name {
  font-size: 18px;
  color: white;
  margin-bottom: 4px;
}

.history-whatsapp {
  font-size: 14px;
  color: #fff8e1;
  opacity: 0.9;
  margin-bottom: 4px;
}

.history-time {
  font-size: 13px;
  opacity: 0.7;
  margin-bottom: 10px;
}

.history-status {
  display: inline-block;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: bold;
  text-transform: uppercase;
}

.history-status.pending {
  background: rgba(255,136,0,0.3);
  color: #ff8800;
}

.history-status.approved {
  background: rgba(0,204,136,0.3);
  color: #00cc88;
}

.history-status.rejected {
  background: rgba(255,68,68,0.3);
  color: #ff4444;
}

/* No History Message */
.no-history {
  text-align: center;
  padding: 40px 0;
  opacity: 0.8;
  font-size: 16px;
  color: var(--ramzan-cream);
}

/* Mobile Fix */
@media (max-width: 480px) {
  .history-item { padding: 14px; }
}
.entertainment-reply.own {
  background: rgba(123,44,255,0.2);
  border-left-color: #00cc88;
}
    .link {
      text-align:center;
      color:rgba(255,255,255,0.7);
      cursor:pointer;
      font-size:14px;
      margin-top:10px;
    }
    .hide { display:none; }
    .password-wrapper {
      position:relative;
    }
    .eye {
      position:absolute;
      right:12px;
      top:50%;
      transform:translateY(-50%);
      cursor:pointer;
    }
    .profile-pic {
      width:90px;
      height:90px;
      border-radius:50%;
      object-fit:cover;
      border:3px solid var(--primary);
      margin:15px auto;
      display:block;
      cursor:pointer;
    }
    .preview-box {
      position:relative;
      margin:10px 0;
      max-width:250px;
    }
    .preview-img {
      width:100%;
      border-radius:12px;
    }
    .remove-img {
      position:absolute;
      top:5px;
      right:5px;
      background:#ff0000aa;
      color:white;
      width:30px;
      height:30px;
      border-radius:50%;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      font-size:18px;
    }
    .loading {
      text-align:center;
      color:#aaa;
      font-size:14px;
      margin:10px 0;
    }
    .status {
      font-size:12px;
      padding:5px 10px;
      border-radius:12px;
      display:inline-block;
      margin:5px 0;
    }/* Feedback Section - Professional Look */
.feedback-form {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(12px);
  border-radius: 18px;
  padding: 20px;
  margin-bottom: 25px;
  border: 1px solid rgba(106,76,255,0.2);
}

.star-rating {
  text-align: center;
  margin: 20px 0;
}

.star {
  font-size: 40px;
  color: #444;
  cursor: pointer;
  transition: 0.3s;
  display: inline-block;
}

.star:hover, .star.active {
  color: #ffd700;
  transform: scale(1.1);
}

#ratingText {
  text-align: center;
  font-size: 16px;
  margin: 10px 0 20px;
  opacity: 0.9;
}

#feedbackText {
  width: 100%;
  padding: 16px;
  background: rgba(255,255,255,0.1);
  border: none;
  border-radius: 16px;
  color: white;
  font-size: 16px;
  resize: vertical;
  min-height: 120px;
  margin-bottom: 20px;
}

#feedbackText::placeholder {
  color: rgba(255,255,255,0.6);
}

/* Individual Feedback Card */
.feedback-item {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 18px;
  margin-bottom: 16px;
  border-left: 4px solid var(--primary);
  transition: 0.3s;
}

.feedback-item:hover {
  transform: translateY(-4px);
  box-shadow: 0 10px 30px rgba(106,76,255,0.2);
}

.feedback-stars {
  font-size: 24px;
  color: #ffd700;
  margin-bottom: 10px;
}

.feedback-text {
  font-size: 16px;
  line-height: 1.6;
  margin-bottom: 15px;
  opacity: 0.95;
}

.feedback-actions {
  display: flex;
  gap: 20px;
  align-items: center;
}

.like-btn, .dislike-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  background: rgba(255,255,255,0.15);
  padding: 10px 18px;
  border-radius: 30px;
  cursor: pointer;
  font-size: 15px;
  transition: 0.3s;
}
.contact-box {
  display: grid;
  gap: 22px;
  margin: 30px 0;
}

.contact-item {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(20px);
  border-radius: 24px;
  padding: 28px;
  text-align: center;
  border: 2px solid rgba(123,44,255,0.3);
  transition: 0.4s;
  box-shadow: 0 12px 35px rgba(0,0,0,0.3);
}

.contact-item:hover {
  transform: translateY(-12px);
  box-shadow: 0 25px 50px rgba(123,44,255,0.5);
  border-color: var(--primary);
}

.contact-icon {
  font-size: 60px;
  margin-bottom: 18px;
}

.contact-title {
  font-size: 22px;
  font-weight: bold;
  margin-bottom: 12px;
  background: linear-gradient(45deg, #7b2cff, #00d4ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.contact-detail {
  font-size: 18px;
  margin-bottom: 10px;
  color: white;
  word-break: break-all;
}

.contact-link {
  color: #00d4ff;
  font-size: 18px;
  text-decoration: none;
  font-weight: bold;
}

.contact-link:hover {
  text-decoration: underline;
}

.contact-note {
  font-size: 15px;
  opacity: 0.9;
  margin-top: 12px;
  color: rgba(255,255,255,0.9);
}

.coming-soon {
  opacity: 0.7;
}

.contact-footer {
  text-align: center;
  margin: 50px 0 20px;
  padding: 25px;
  background: rgba(123,44,255,0.15);
  border-radius: 24px;
  border: 2px dashed rgba(123,44,255,0.4);
}

.contact-footer p {
  margin: 10px 0;
  font-size: 17px;
}

.contact-footer strong {
  background: linear-gradient(90deg, #7b2cff, #00d4ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-size: 20px;
}
.like-btn:hover {
  background: rgba(0,204,136,0.3);
}

.dislike-btn:hover {
  background: rgba(255,68,68,0.3);
}

.like-btn.liked, .dislike-btn.disliked {
  background: var(--primary);
  font-weight: bold;
}

.like-count, .dislike-count {
  font-weight: bold;
}
    .pending { background:#ff8800; }
    .processing { background:#4488ff; }
    .approved { background:#00aa55; }
    .rejected { background:#aa0000; }

    /* Live Chat - Fixed Left/Right Alignment */
    .chat-container {
      height:55vh;
      overflow-y:auto;
      display:flex;
      flex-direction:column;
      padding:15px 10px;
      gap:15px;
      background: rgba(255,255,255,0.05);
      border-radius:16px;
      margin-bottom:15px;
    }
    .message {
      max-width:75%;
      padding:14px 18px;
      border-radius:20px;
      line-height:1.5;
      position:relative;
      word-wrap:break-word;
      box-shadow: 0 3px 12px rgba(0,0,0,0.3);
    }
  .message.user {
  align-self:flex-end;
  background:#00cc88;  /* Green colour for user messages */
  color:white;
  border-bottom-right-radius:5px;
}
/* ========= PREMIUM BANKING APP THEME 2026 - AYESSHA SPECIAL ========= */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

:root {
  --bg: #0d1117;
  --card: #161b22;
  --border: #30363d;
  --primary: #58a6ff;
  --green: #238636;
  --red: #da3633;
  --text: #f0f6fc;
  --text-muted: #8b949e;
  --success: #238636;
}

* { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  font-size: 15px;
  line-height: 1.6;
  padding-bottom: 100px;
}

/* Clean Banking Cards - Super Small & Comfortable */
.container { max-width: 420px; margin: 0 auto; padding: 12px; }
.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 20px;
  margin: 16px 0;
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  animation: fadeIn 0.5s ease;
}

/* Banking Style Headings */
h1 {
  font-size: 24px;
  font-weight: 600;
  text-align: center;
  margin: 16px 0;
  color: white;
}
/* ========= PREMIUM BANKING FEEDBACK SECTION ========= */
.banking-feedback {
  background: var(--card);
  border-radius: 20px;
  padding: 24px;
  margin: 20px 0;
  border: 1px solid var(--border);
  text-align: center;
}

.rating-section {
  margin: 20px 0 30px;
}

.stars-large {
  font-size: 48px;
  letter-spacing: 12px;
}

.star-large {
  color: #394150;
  cursor: pointer;
  transition: all 0.3s ease;
  text-shadow: 0 2px 10px rgba(0,0,0,0.3);
}

.star-large:hover, .star-large.active {
  color: #ffd700;
  transform: scale(1.2);
  text-shadow: 0 0 20px #ffd70080;
}

.rating-text {
  margin-top: 16px;
  font-size: 17px;
  color: var(--text-muted);
  font-weight: 500;
}

#feedbackText {
  background: var(--bg);
  border: 1.5px solid var(--border);
  border-radius: 16px;
  padding: 16px;
  margin: 20px 0;
  font-size: 15px;
  color: white;
  resize: none;
}

.submit-btn {
  background: var(--primary);
  padding: 16px;
  border-radius: 16px;
  font-weight: 600;
  font-size: 16px;
  margin-top: 10px;
}

.submit-btn:hover {
  background: #1f6feb;
}

/* Feedback History - Banking Style */
.feedback-history {
  margin-top: 30px;
}

.feedback-item {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 18px;
  margin: 14px 0;
}

.feedback-stars {
  font-size: 20px;
  color: #ffd700;
  margin-bottom: 8px;
  letter-spacing: 4px;
}

.feedback-text {
  font-size: 15px;
  color: var(--text);
  line-height: 1.6;
  margin: 12px 0;
}

.feedback-meta {
  font-size: 13px;
  color: var(--text-muted);
  text-align: right;
}

/* Like/Dislike - Banking Style */
.feedback-actions {
  display: flex;
  justify-content: flex-end;
  gap: 16px;
  margin-top: 12px;
}

.like-btn, .dislike-btn {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text-muted);
  padding: 8px 16px;
  border-radius: 12px;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.like-btn.liked {
  background: rgba(34,197,94,0.2);
  border-color: var(--success);
  color: var(--success);
}

.dislike-btn.disliked {
  background: rgba(218,54,51,0.2);
  border-color: var(--red);
  color: var(--red);
}
/* Clean Buttons - Banking Blue */
button, .small-btn {
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 12px;
  padding: 14px;
  font-weight: 600;
  font-size: 15px;
  cursor: pointer;
  width: 100%;
  margin: 10px 0;
  transition: 0.2s;
}

button:hover, .small-btn:hover {
  background: #1f6feb;
  transform: translateY(-1px);
}

/* Inputs - Clean & Minimal */
input, textarea {
  width: 100%;
  padding: 14px 16px;
  margin: 10px 0;
  background: #0d1117;
  border: 1px solid var(--border);
  border-radius: 12px;
  color: white;
  font-size: 15px;
}

input:focus, textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(88,166,255,0.2);
}

/* Links */
.link {
  text-align: center;
  color: var(--primary);
  font-weight: 500;
  margin: 16px 0;
  font-size: 14.5px;
  cursor: pointer;
}

/* User Items - Banking List Style */
.user-item, .friend-item, .request-item {
  background: transparent;
  padding: 16px 0;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.user-info {
  display: flex;
  align-items: center;
  gap: 14px;
}

.user-info img {
  width: 48px;
  height: 48px;
  border-radius: 12px;
}

.user-info strong {
  font-weight: 500;
  font-size: 16px;
}

/* Private Chat - Clean Banking DM */
.private-msg {
  max-width: 80%;
  padding: 12px 16px;
  border-radius: 18px;
  margin: 8px 0;
  font-size: 15px;
}

.private-msg.own {
  background: var(--primary);
  color: white;
  align-self: flex-end;
  border-bottom-right-radius: 4px;
}

.private-msg.other {
  background: #30363d;
  color: var(--text);
  align-self: flex-start;
  border-bottom-left-radius: 4px;
}

/* ========= POWERED BY MRCRAZYTEAM - FIXED BOTTOM BANNER ========= */
#mrCrazyBanner {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: linear-gradient(135deg, rgba(13, 17, 23, 0.98), rgba(20, 18, 38, 0.95));
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-top: 1px solid rgba(123, 44, 255, 0.3);
  border-radius: 0 0 20px 20px; /* Gentle curve at bottom edges */
  padding: 12px 20px;
  text-align: center;
  font-size: 14px;
  font-weight: 600;
  color: #b0b0ff;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  z-index: 9998;
  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.6);
  animation: none; /* No animation to prevent any movement */
  pointer-events: none;
  transform: translateY(0); /* Locked at bottom */
  opacity: 1; /* Fully opaque, no fade */
  transition: none; /* No transitions to avoid popping */
}

#mrCrazyBanner strong {
  color: #7b2cff;
  font-weight: 700;
  font-size: 15px;
  background: linear-gradient(90deg, #7b2cff, #00d4ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

#mrCrazyBanner .spark {
  font-size: 16px;
  opacity: 0.8; /* Static sparkle, no animation */
}

/* No Animations - Fully Static */
@keyframes subtleGlow { /* Removed usage */ }
@keyframes gentleSparkle { /* Removed usage */ }

/* Mobile Optimization - Full Width, No Overlap */
@media (max-width: 480px) {
  #mrCrazyBanner {
    padding: 10px 15px;
    font-size: 13px;
    gap: 6px;
    border-radius: 0 0 15px 15px;
  }
  #mrCrazyBanner strong { font-size: 14px; }
  .spark { font-size: 14px; }
}

/* Ensure Body Has Space - Prevents Overlap */
body {
  padding-bottom: 60px; /* Exact space for banner height */
}
.message.mrcrazyteam {
  align-self:flex-start;
  background:#ff4444;  /* Red colour for MrCrazyTeam messages */
  color:white;
  border-bottom-left-radius:5px;
}
    .message img {
      max-width:220px;
      border-radius:12px;
      margin-top:10px;
      display:block;
    }
    .message small {
      display:block;
      margin-top:10px;
      font-size:11px;
      opacity:0.8;
      text-align:right;
    }
    .msg-actions {
      position:absolute;
      top:10px;
      right:15px;
      opacity:0;
      transition:opacity 0.3s;
    }
    .message.user:hover .msg-actions {
      opacity:1;
    }
    .msg-actions button {
      background:none;
      border:none;
      color:white;
      cursor:pointer;
      font-size:16px;
      margin-left:8px;
    }
.policy-container {
  max-width: 600px;
  margin: 0 auto;
}

.policy-header {
  text-align: center;
  margin-bottom: 40px;
}

.policy-header h2 {
  font-size: 32px;
  background: linear-gradient(90deg, #7b2cff, #00d4ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 10px;
}


/* CEO Section */
.ceo-section {
  background: linear-gradient(135deg, rgba(123,44,255,0.2), rgba(0,212,255,0.1));
  border-radius: 30px;
  padding: 40px;
  margin: 50px 0;
  text-align: center;
  border: 2px solid rgba(123,44,255,0.4);
  box-shadow: 0 20px 50px rgba(123,44,255,0.3);
}

.ceo-avatar {
  width: 120px;
  height: 120px;
  background: var(--primary);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 70px;
  margin: 0 auto 20px;
  box-shadow: 0 15px 40px rgba(123,44,255,0.6);
}

.ceo-info h3 {
  font-size: 20px;
  opacity: 0.9;
  margin-bottom: 8px;
}

.ceo-info h2 {
  font-size: 36px;
  font-weight: bold;
  background: linear-gradient(90deg, #7b2cff, #00d4ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 15px;
}

.policy-footer {
  text-align: center;
  margin: 50px 0;
  padding: 30px;
  background: rgba(123,44,255,0.15);
  border-radius: 28px;
  border: 2px dashed rgba(123,44,255,0.5);
}

.policy-footer p {
  font-size: 18px;
  margin: 12px 0;
}

.policy-footer strong {
  font-size: 24px;
  background: linear-gradient(90deg, #ff4444, #00cc88);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}/* ========= RAMZAN KAREEM 2026 - ULTRA SLIM & KHUBSURAT VIP EDITION ========= */
@import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Noto+Naskh+Arabic:wght@400;700&display=swap');

:root {
  --ramzan-dark: #0b1f21;
  --ramzan-green: #0a5c4e;
  --ramzan-gold: #c9a227;
  --ramzan-cream: #fff8e1;
  --text: #fff8e1;
  --glow: rgba(201,162,39,0.4);
}

* { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family: 'Amiri', 'Noto Naskh Arabic', serif;
  background: #0b1f21;
  color: var(--text);
  min-height: 100vh;
  font-size: 15px;
  line-height: 1.6;
  padding-bottom: 90px;
  overflow-x: hidden;
}

/* Slim & Beautiful Falling Stars Background */
body::before {
  content: '';
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: 
    radial-gradient(circle at 15% 15%, var(--glow), transparent 30%),
    radial-gradient(circle at 85% 10%, var(--glow), transparent 30%);
  z-index: -1;
  animation: nightSky 20s ease-in-out infinite;
}

/* Slim Chand – Top Right */
.chand-slim {
  position: fixed;
  top: 18px;
  right: 18px;
  font-size: 70px;
  color: rgba(255,248,231,0.22);
  z-index: 10;
  animation: chandPulse 10s ease-in-out infinite;
  transform: rotate(-35deg);
}

/* Slim Ramzan Kareem Top Bar */
.ramzan-top-slim {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  padding: 16px 20px;
  background: rgba(11,31,33,0.94);
  backdrop-filter: blur(18px);
  text-align: center;
  z-index: 999;
  border-bottom: 1px solid rgba(201,162,39,0.25);
  font-size: 19px;
  color: var(--ramzan-gold);
  font-weight: bold;
  letter-spacing: 1.8px;
  text-shadow: 0 0 20px rgba(201,162,39,0.5);
}

/* Ultra Slim Cards */
.container { max-width: 380px; margin: 90px auto 0; padding: 10px; }
.card {
  background: rgba(11,31,33,0.96);
  backdrop-filter: blur(20px);
  border-radius: 26px;
  padding: 22px;
  margin: 14px 0;
  border: 1.8px solid rgba(201,162,39,0.3);
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}

/* Slim Headings */
h1 {
  font-size: 30px;
  text-align: center;
  margin: 12px 0;
  color: var(--ramzan-gold);
  text-shadow: 0 0 18px rgba(201,162,39,0.5);
  font-weight: normal;
}

/* Slim Buttons */
button, .small-btn {
  background: rgba(10,92,78,0.92);
  color: white;
  border: 2px solid var(--ramzan-gold);
  border-radius: 20px;
  padding: 13px;
  font-size: 15.5px;
  font-weight: bold;
  cursor: pointer;
  width: 100%;
  margin: 10px 0;
  transition: all 0.35s ease;
}

button:hover, .small-btn:hover {
  transform: translateY(-4px);
  background: var(--ramzan-green);
  box-shadow: 0 12px 30px rgba(10,92,78,0.5);
}

/* Slim Inputs */
input, textarea {
  background: rgba(255,248,231,0.1);
  border: 1.8px solid rgba(201,162,39,0.35);
  border-radius: 18px;
  padding: 13px 16px;
  color: white;
  font-size: 15px;
  margin: 9px 0;
}

input:focus, textarea:focus {
  border-color: var(--ramzan-gold);
  box-shadow: 0 0 22px rgba(201,162,39,0.35);
}

/* Slim Banner */
#mrCrazyBanner {
  position: fixed;
  bottom: 16px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(11,31,33,0.97);
  backdrop-filter: blur(22px);
  border: 2px solid var(--ramzan-gold);
  border-radius: 50px;
  padding: 10px 28px;
  font-size: 15.5px;
  font-weight: bold;
  color: var(--ramzan-gold);
  box-shadow: 0 10px 30px rgba(201,162,39,0.3);
  z-index: 9999;
  animation: slimFloat 6s ease-in-out infinite;
}/* ========= CHECK HISTORY SECTION - SLIM RAMZAN VIP ========= */
.greet-card {
  background: rgba(11,31,33,0.95);
  backdrop-filter: blur(20px);
  border: 1.8px solid rgba(201,162,39,0.4);
  border-radius: 24px;
  padding: 18px;
  text-align: center;
  margin: 20px 0;
  position: relative;
  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  font-family: 'Amiri', serif;
}
/* Informations Section - Slim Admin Videos */
.info-item {
  background: rgba(11,31,33,0.95);
  backdrop-filter: blur(20px);
  border: 1.8px solid rgba(201,162,39,0.4);
  border-radius: 24px;
  padding: 20px;
  margin: 15px 0;
  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  transition: 0.3s;
  position: relative;
  font-family: 'Amiri', serif;
}

.info-item:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 40px rgba(201,162,39,0.3);
  border-color: var(--ramzan-gold);
}

.info-number {
  position: absolute;
  top: -10px;
  left: 20px;
  background: var(--ramzan-gold);
  color: var(--ramzan-dark);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: bold;
  box-shadow: 0 4px 15px rgba(201,162,39,0.4);
}

.info-title {
  font-size: 22px;
  color: var(--ramzan-gold);
  margin-bottom: 10px;
  font-weight: bold;
  text-shadow: 0 0 10px rgba(201,162,39,0.3);
}

.info-desc {
  font-size: 16px;
  color: var(--ramzan-cream);
  line-height: 1.6;
  margin-bottom: 12px;
  opacity: 0.9;
}

.info-upload {
  font-size: 14px;
  color: var(--ramzan-green);
  margin-bottom: 15px;
  font-style: italic;
}

.watch-btn {
  background: linear-gradient(135deg, #ff4444, #cc0000);
  color: white;
  border: none;
  border-radius: 25px;
  padding: 12px 25px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
  box-shadow: 0 6px 20px rgba(255,68,68,0.3);
  display: block;
  margin: 0 auto;
  width: fit-content;
}

.watch-btn:hover {
  transform: scale(1.05);
  background: #cc0000;
  box-shadow: 0 10px 30px rgba(255,68,68,0.5);
}

/* Mobile Slim Fix */
@media (max-width: 480px) {
  .info-item { padding: 15px; margin: 10px 0; }
  .info-title { font-size: 20px; }
}
.greet-icon {
  font-size: 50px;
  margin-bottom: 10px;
  color: var(--ramzan-gold);
}

#greetMsg {
  font-size: 20px;
  color: white;
  font-weight: bold;
  margin: 0;
}

.lang-container {
  text-align: center;
  margin: 20px 0;
}
/* Share Friends - Premium Glow Style */
.share-container {
  text-align: center;
  padding: 20px 0;
}

.share-greeting {
  margin-bottom: 30px;
}

.share-icon {
  font-size: 60px;
  margin-bottom: 15px;
  color: var(--ramzan-gold);
  text-shadow: 0 0 20px rgba(201,162,39,0.6);
}

.share-greeting h2 {
  font-size: 28px;
  color: var(--ramzan-gold);
  margin-bottom: 12px;
  text-shadow: 0 0 15px rgba(201,162,39,0.5);
}

.share-greeting p {
  font-size: 16px;
  color: var(--ramzan-cream);
  opacity: 0.9;
}

.share-link-box {
  background: rgba(11,31,33,0.95);
  backdrop-filter: blur(20px);
  border: 2px solid rgba(201,162,39,0.5);
  border-radius: 20px;
  padding: 25px;
  margin: 0 auto;
  max-width: 360px;
  box-shadow: 0 10px 30px rgba(201,162,39,0.3);
}

.share-link {
  background: rgba(255,248,231,0.1);
  border-radius: 16px;
  padding: 16px;
  font-size: 15px;
  color: var(--ramzan-gold);
  word-break: break-all;
  margin-bottom: 20px;
  border: 1px dashed var(--ramzan-gold);
}

.share-buttons {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.share-btn {
  padding: 16px;
  border: none;
  border-radius: 50px;
  font-size: 17px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.share-btn.whatsapp {
  background: linear-gradient(135deg, #25D366, #128C7E);
  color: white;
  box-shadow: 0 8px 20px rgba(37,213,102,0.4);
}

.share-btn.whatsapp:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 30px rgba(37,213,102,0.6);
}
/* New Mobile-First Entertainment Chat - WhatsApp Style */
.ent-chat-container {
  height: 55vh; /* Mobile pe acha fit */
  max-height: 60vh;
  overflow-y: auto;
  padding: 15px 10px;
  background: rgba(11,31,33,0.95);
  border-radius: 16px;
  margin-bottom: 15px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  scrollbar-width: thin;
  scrollbar-color: var(--ramzan-gold) transparent;
}

.ent-msg {
  max-width: 80%;
  padding: 10px 14px;
  border-radius: 18px;
  font-size: 15px;
  line-height: 1.4;
  position: relative;
  word-wrap: break-word;
  word-break: break-word;
  hyphens: auto;
}

.ent-msg.own {
  align-self: flex-end;
  background: linear-gradient(135deg, var(--ramzan-green), #0a7a66);
  color: white;
  border-bottom-right-radius: 4px;
}

.ent-msg.other {
  align-self: flex-start;
  background: rgba(255,255,255,0.12);
  color: var(--ramzan-cream);
  border-bottom-left-radius: 4px;
}

.ent-msg-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
  font-size: 13px;
}

.ent-msg-pic {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--ramzan-gold);
}

.ent-msg-username {
  font-weight: 600;
  color: var(--ramzan-gold);
}

.ent-msg-text {
  font-size: 15px;
}

.ent-msg img {
  max-width: 220px;
  border-radius: 12px;
  margin-top: 8px;
  display: block;
}

.ent-msg-time {
  font-size: 11px;
  opacity: 0.7;
  margin-top: 4px;
  text-align: right;
}

/* Input Bar - Fixed Bottom Style */
.ent-input-bar {
  position: sticky;
  bottom: 0;
  background: rgba(11,31,33,0.98);
  backdrop-filter: blur(15px);
  border-top: 1px solid rgba(201,162,39,0.3);
  padding: 12px 10px;
  display: flex;
  align-items: center;
  gap: 10px;
  z-index: 10;
}

.ent-attach {
  width: 45px;
  height: 45px;
  background: rgba(201,162,39,0.2);
  border: none;
  border-radius: 50%;
  font-size: 22px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.ent-chat-input {
  flex: 1;
  padding: 12px 16px;
  background: rgba(255,248,231,0.1);
  border: 1.5px solid rgba(201,162,39,0.4);
  border-radius: 30px;
  color: white;
  font-size: 15px;
}

.ent-chat-input::placeholder {
  color: rgba(255,248,231,0.6);
}

.ent-send {
  width: 60px;
  height: 45px;
  background: var(--ramzan-green);
  color: white;
  border: none;
  border-radius: 30px;
  font-weight: bold;
  cursor: pointer;
}

/* Scrollbar Custom */
.ent-chat-container::-webkit-scrollbar {
  width: 6px;
}
.ent-chat-container::-webkit-scrollbar-thumb {
  background: var(--ramzan-gold);
  border-radius: 10px;
}
/* Social World - Slim Balance Board */
.social-balance-board {
  background: rgba(11,31,33,0.98);
  backdrop-filter: blur(20px);
  border: 2px solid rgba(201,162,39,0.45);
  border-radius: 18px;
  padding: 28px 20px;
  text-align: center;
  box-shadow: 0 8px 25px rgba(201,162,39,0.25);
  margin: 25px auto;
  max-width: 380px;
}

.balance-title {
  font-size: 18px;
  color: var(--ramzan-gold);
  margin-bottom: 15px;
  opacity: 0.9;
}

.balance-value {
  font-size: 48px;
  font-weight: bold;
  color: white;
  margin: 12px 0;
  text-shadow: 0 0 18px rgba(201,162,39,0.5);
}

.balance-note p {
  font-size: 15px;
  opacity: 0.85;
  margin: 8px 0;
  line-height: 1.5;
}

.social-placeholder {
  text-align: center;
  padding: 30px 0;
  opacity: 0.7;
  font-size: 15px;
}

/* Mobile pe adjust */
@media (max-width: 480px) {
  .social-balance-board {
    padding: 22px 15px;
    margin: 20px auto;
  }
  .balance-value {
    font-size: 40px;
  }
}
/* Mobile Adjustments */
@media (max-width: 480px) {
  .ent-chat-container { 
    height: 50vh; 
    padding: 10px 8px; 
  }
  .ent-msg { 
    max-width: 85%; 
    font-size: 14px; 
    padding: 9px 12px; 
  }
  .ent-input-bar { 
    padding: 10px 8px; 
  }
  .ent-chat-input { 
    font-size: 14px; 
    padding: 10px 14px; 
  }
  .ent-send { 
    width: 55px; 
  }
}
.deposit-chat-box {
  height: 50vh;
  overflow-y: auto;
  background: rgba(11,31,33,0.95);
  border: 1.5px solid rgba(201,162,39,0.4);
  border-radius: 16px;
  padding: 15px;
  margin-bottom: 15px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.bot-msg, .user-msg {
  max-width: 80%;
  padding: 10px 14px;
  border-radius: 18px;
  font-size: 15px;
  line-height: 1.4;
}

.bot-msg {
  align-self: flex-start;
  background: linear-gradient(135deg, var(--ramzan-green), #0a7a66);
  color: white;
}

.user-msg {
  align-self: flex-end;
  background: rgba(255,255,255,0.12);
  color: var(--ramzan-cream);
}

.typing {
  font-style: italic;
  opacity: 0.7;
  font-size: 14px;
}

.deposit-methods {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.method-btn {
  padding: 14px;
  background: var(--ramzan-gold);
  color: #0b1f21;
  border: none;
  border-radius: 30px;
  font-weight: bold;
  cursor: pointer;
}
.share-btn.copy {
  background: linear-gradient(135deg, var(--ramzan-gold), #b5892e);
  color: var(--ramzan-dark);
  box-shadow: 0 8px 20px rgba(201,162,39,0.5);
}

.share-btn.copy:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 30px rgba(201,162,39,0.7);
}

.share-result {
  margin-top: 25px;
  padding: 15px;
  border-radius: 16px;
  font-size: 16px;
}

.share-result.success {
  background: rgba(0,204,136,0.2);
  border: 1px solid #00cc88;
  color: #00cc88;
}

.share-result.error {
  background: rgba(255,68,68,0.2);
  border: 1px solid #ff4444;
  color: #ff4444;
}

/* Mobile fix */
@media (max-width: 480px) {
  .share-btn {
    font-size: 16px;
    padding: 14px;
  }
}
.lang-btn {
  background: rgba(10,92,78,0.9);
  color: white;
  border: 2px solid var(--ramzan-gold);
  border-radius: 20px;
  padding: 14px 24px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
  font-family: 'Amiri', serif;
  margin-top: 10px;
}

.lang-btn:hover {
  background: var(--ramzan-gold);
  transform: translateY(-3px);
}

.loading-card, .success-card {
  background: rgba(0,92,78,0.95);
  backdrop-filter: blur(20px);
  border: 2px solid rgba(201,162,39,0.4);
  border-radius: 24px;
  padding: 20px;
  text-align: center;
  margin: 20px 0;
  position: relative;
  box-shadow: 0 10px 30px rgba(0,0,0,0.4);
  animation: glowPulse 2s ease-in-out infinite;
}

.spinner {
  font-size: 40px;
  margin-bottom: 10px;
  color: var(--ramzan-gold);
}

.options-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 12px;
  max-width: 300px;
  margin: 0 auto 20px;
}

.option-btn {
  background: rgba(10,92,78,0.9);
  color: white;
  border: 2px solid var(--ramzan-gold);
  border-radius: 20px;
  padding: 16px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
  font-family: 'Amiri', serif;
}
/* Top Admin Banner - Cool Animated Slide & Glow */
.admin-banner {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background: linear-gradient(135deg, #ff6b6b, #4ecdc4, #45b7d1);
  color: white;
  z-index: 10000;
  box-shadow: 0 4px 20px rgba(255,107,107,0.5);
  animation: slideDown 0.8s ease-out, glowPulse 3s infinite;
  border-bottom: 3px solid rgba(255,255,255,0.3);
}

.banner-content {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 20px;
  max-width: 480px;
  margin: 0 auto;
  font-size: 16px;
  font-weight: bold;
  text-align: center;
}

.banner-close {
  cursor: pointer;
  font-size: 24px;
  margin-left: 15px;
  opacity: 0.8;
  transition: 0.3s;
}

.banner-close:hover { opacity: 1; transform: scale(1.2); }

@keyframes slideDown {
  from { transform: translateY(-100%); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes glowPulse {
  0%, 100% { box-shadow: 0 4px 20px rgba(255,107,107,0.5); }
  50% { box-shadow: 0 4px 30px rgba(78,205,196,0.8); }
}
.service-tabs {
  display: flex;
  gap: 8px;
  margin: 15px 0 20px;
  overflow-x: auto;
  padding-bottom: 8px;
}

.tab-btn {
  padding: 8px 16px;
  background: rgba(201, 162, 39, 0.1);
  border: 1px solid rgba(201, 162, 39, 0.4);
  border-radius: 25px;
  color: var(--ramzan-gold);
  font-size: 14px;
  white-space: nowrap;
  cursor: pointer;
}

.tab-btn.active {
  background: var(--ramzan-gold);
  color: #0b1f21;
}

.balance-header {
  background: rgba(201, 162, 39, 0.15);
  padding: 10px;
  border-radius: 10px;
  text-align: center;
  margin-bottom: 20px;
  font-size: 16px;
  border: 1px dashed var(--ramzan-gold);
}

.slim-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.slim-service {
  background: rgba(11, 31, 33, 0.95);
  border: 1px solid rgba(201, 162, 39, 0.3);
  border-radius: 14px;
  padding: 14px;
  cursor: pointer;
}

.slim-service:hover {
  border-color: var(--ramzan-gold);
  box-shadow: 0 4px 15px rgba(201, 162, 39, 0.2);
}

.slim-service h4 {
  color: var(--ramzan-gold);
  margin-bottom: 6px;
  font-size: 16px;
}

.slim-service .price {
  color: white;
  font-weight: bold;
}

#serviceOrderForm {
  background: rgba(11, 31, 33, 0.98);
  border: 2px solid var(--ramzan-gold);
  border-radius: 16px;
  padding: 18px;
  margin-top: 20px;
}

#serviceOrderForm input {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  background: rgba(255, 248, 231, 0.08);
  border: 1.5px solid rgba(201, 162, 39, 0.4);
  border-radius: 10px;
  color: white;
}

#serviceOrderForm button {
  width: 100%;
  padding: 14px;
  margin: 8px 0;
  border-radius: 30px;
  font-weight: bold;
}

.back {
  background: #ff8800 !important;
  color: white;
}

.back-link {
  text-align: center;
  margin-top: 25px;
  color: var(--ramzan-gold);
  cursor: pointer;
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
}
/* Mobile Fix */
@media (max-width: 480px) {
  .banner-content { padding: 10px 15px; font-size: 14px; }
  .banner-close { font-size: 20px; margin-left: 10px; }
}
.option-btn:hover {
  background: var(--ramzan-gold);
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(201,162,39,0.3);
}

#complaintCheckForm input, #getAppForm input, #movieCheckForm input {
  background: rgba(255,248,231,0.1);
  border: 1.8px solid rgba(201,162,39,0.35);
  border-radius: 18px;
  padding: 14px 16px;
  color: white;
  font-size: 15px;
  margin: 10px 0;
  width: 100%;
}

#complaintCheckForm input:focus, #getAppForm input:focus, #movieCheckForm input:focus {
  border-color: var(--ramzan-gold);
  box-shadow: 0 0 20px rgba(201,162,39,0.3);
}

#complaintCheckForm button, #getAppForm button, #movieCheckForm button {
  background: var(--ramzan-green);
  color: white;
  border: none;
  border-radius: 20px;
  padding: 14px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
  width: 100%;
  margin-top: 10px;
  transition: 0.3s;
}

#complaintCheckForm button:hover, #getAppForm button:hover, #movieCheckForm button:hover {
  background: #0d7a66;
  transform: scale(1.02);
}

#complaintResult, #appResult, #movieResult {
  margin-top: 15px;
  padding: 15px;
  background: rgba(255,255,255,0.1);
  border-radius: 16px;
  text-align: center;
}

@keyframes glowPulse {
  0%, 100% { box-shadow: 0 10px 30px rgba(0,0,0,0.4); }
  50% { box-shadow: 0 15px 40px rgba(201,162,39,0.2); }
}

/* Mobile Slim Fix */
@media (max-width: 480px) {
  .options-grid { gap: 10px; max-width: 100%; }
  .loading-card, .success-card { padding: 16px; }
}

#mrCrazyBanner strong {
  color: white;
  font-size: 17px;
}

/* Slim Animations */
@keyframes nightSky {
  0%, 100% { opacity: 0.8; }
  50% { opacity: 1; }
}
/* SIM History - Slim Ramzan VIP Style */
.sim-history-item {
  background: rgba(11,31,33,0.95);
  backdrop-filter: blur(20px);
  border: 1.8px solid rgba(201,162,39,0.4);
  border-radius: 24px;
  padding: 18px;
  margin-bottom: 15px;
  position: relative;
  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  transition: all 0.3s ease;
}

.sim-history-item:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 35px rgba(201,162,39,0.3);
  border-color: var(--ramzan-gold);
}

.sim-query {
  font-size: 18px;
  color: white;
  font-weight: bold;
  margin-bottom: 6px;
}

.sim-reason {
  font-size: 15px;
  color: var(--ramzan-cream);
  opacity: 0.9;
  margin-bottom: 10px;
}

.sim-time {
  font-size: 13px;
  opacity: 0.7;
  margin-bottom: 10px;
  text-align: right;
}

.sim-status {
  display: inline-block;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: bold;
  text-transform: uppercase;
  margin-top: 8px;
}

.sim-status.pending {
  background: rgba(255,136,0,0.3);
  color: #ff8800;
  border: 1px solid #ff8800;
}

.sim-status.approved {
  background: rgba(0,204,136,0.3);
  color: #00cc88;
  border: 1px solid #00cc88;
}

.sim-status.rejected {
  background: rgba(255,68,68,0.3);
  color: #ff4444;
  border: 1px solid #ff4444;
}

.sim-reply {
  background: rgba(0,204,136,0.15);
  padding: 12px;
  border-radius: 12px;
  margin-top: 12px;
  border-left: 4px solid #00cc88;
  font-size: 15px;
  color: var(--ramzan-cream);
}

.sim-reply.none {
  background: rgba(255,68,68,0.1);
  border-left-color: #ff4444;
  opacity: 0.8;
}
@keyframes chandPulse {
  0%, 100% { text-shadow: 0 0 30px rgba(255,248,231,0.3); }
  50% { text-shadow: 0 0 60px rgba(255,248,231,0.5); }
}

@keyframes slimFloat {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(-8px); }
}
/* ========= VIP RAMZAN LIVE CARD - ULTRA SLIM & KHUBSURAT ========= */
.ramzan-live-card {
  background: rgba(11,31,33,0.95);
  backdrop-filter: blur(20px);
  border: 1.8px solid rgba(201,162,39,0.4);
  border-radius: 26px;
  padding: 16px 20px;
  margin: 15px auto;
  max-width: 360px;
  text-align: center;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  position: relative;
  overflow: hidden;
  font-family: 'Amiri', serif;
}

.ramzan-live-card::before {
  content: '☾';
  position: absolute;
  top: 8px;
  right: 12px;
  font-size: 32px;
  color: rgba(255,248,231,0.2);
  animation: moonPulse 8s ease-in-out infinite;
}

.live-date {
  font-size: 17px;
  color: var(--ramzan-gold);
  font-weight: bold;
  letter-spacing: 1px;
  margin-bottom: 4px;
}

.live-time {
  font-size: 28px;
  font-weight: bold;
  color: white;
  text-shadow: 0 0 20px rgba(201,162,39,0.5);
  margin: 6px 0;
  letter-spacing: 2px;
}

.live-location {
  font-size: 15px;
  color: #c9a227;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  margin-top: 6px;
}

.live-location::before {
  content: '📍';
  font-size: 18px;
}

#cityName {
  font-weight: bold;
  color: var(--ramzan-gold);
}

@keyframes moonPulse {
  0%, 100% { opacity: 0.2; transform: scale(1); }
  50% { opacity: 0.4; transform: scale(1.1); }
}
/* Mobile Super Slim */
@media (max-width: 480px) {
  .container { padding: 8px; margin-top: 80px; }
  .card { padding: 20px; margin: 12px 0; }
  h1 { font-size: 28px; }
}
    .chat-input {
      display:flex;
      gap:10px;
      margin-top:10px;
      align-items:center;
    }
    .chat-input input {
      flex:1;
      padding:16px;
      background:rgba(255,255,255,0.1);
      border:none;
      border-radius:30px;
      color:white;
      font-size:16px;
    }
    .chat-input input::placeholder {
      color:rgba(255,255,255,0.6);
    }
    .chat-input button {
      width:auto;
      padding:16px 24px;
      background:var(--primary);
      border:none;
      border-radius:30px;
      font-weight:bold;
      cursor:pointer;
    }
    .info-row {
      background: rgba(255,255,255,0.1);
      padding:12px;
      border-radius:10px;
      margin:10px 0;
      word-break: break-all;
    }
  </style>
</head>
<body>
  <!-- Top Animated Banner - Admin Controlled -->
<div id="adminBanner" class="admin-banner hide">
  <div class="banner-content">
    <span id="bannerMsg"></span>
    <span class="banner-close" onclick="closeBanner()">×</span>
  </div>
</div>
<!-- Floating WhatsApp Button - Green Pop Style -->
<div id="whatsappFloatBtn" class="whatsapp-float">
  <a href="https://whatsapp.com/channel/0029VbBwFGO9Bb5s9beJ201f" target="_blank">
    <i class="whatsapp-icon">📱</i> <!-- Ya WhatsApp icon use kar: <img src="whatsapp-icon.png" alt="WA"> -->
  </a>
</div>
<div class="chand-slim">☾✨</div>
<div class="ramzan-top-slim">رمضان مبارک بہت جلد آ رہا ہے </div>
  
<!-- Notification Popups -->
<div id="normalNotification" class="notification-popup hide">
  <div class="notification-content">
    <span class="close-btn" onclick="closeNormalNotification()">×</span>
    <p id="normalMessage"></p>
  </div>
</div>

<div id="emergencyNotification" class="notification-popup hide">
  <div class="notification-content emergency">
    <span class="close-btn" onclick="closeEmergencyNotification()">×</span>
    <p id="emergencyMessage" style="font-size:18px; font-weight:bold;"></p>
    <button id="emergencyDownloadBtn" onclick="openEmergencyLink()">Download Update Now</button>
  </div>
</div>

<div class="container">

  <!-- Login Page -->
  <div id="loginPage" class="card">
    <h1>خوش آمدید 👋</h1>
    <input type="email" id="loginEmail" placeholder="Email" />
    <div class="password-wrapper">
      <input type="password" id="loginPass" placeholder="Password" />
      <span class="eye" onclick="togglePass('loginPass')">👁️</span>
    </div>
    <button onclick="login()">Login</button>
    <div class="link" onclick="showSignup()">Don't have an account? Sign Up</div>
    <div class="link" onclick="showForgot()">Forgot Password?</div>
  </div>

  <!-- Signup Page -->
  <div id="signupPage" class="card hide">
    <h1>Create Account 🚀</h1>
    <input type="text" id="username" placeholder="Username" />
    <input type="email" id="signupEmail" placeholder="Email" />
    <div class="password-wrapper">
      <input type="password" id="signupPass" placeholder="Password" />
      <span class="eye" onclick="togglePass('signupPass')">👁️</span>
    </div>
    <div class="password-wrapper">
      <input type="password" id="confirmPass" placeholder="Confirm Password" />
      <span class="eye" onclick="togglePass('confirmPass')">👁️</span>
    </div>
    <button onclick="signup()">Sign Up</button>
    <div class="link" onclick="showLogin()">Already have an account? Login</div>
  </div>

  <!-- Forgot Password -->
  <div id="forgotPage" class="card hide">
    <h1>Reset Password 🔑</h1>
    <input type="email" id="forgotEmail" placeholder="Enter your email" />
    <button onclick="forgotPass()">Send Reset Link</button>
    <div class="link" onclick="showLogin()">Back to Login</div>
  </div>
<!-- VIP RAMZAN LIVE CARD - SMALL & KHUBSURAT -->
<div class="ramzan-live-card">
  <div class="live-date" id="liveDate">Loading...</div>
  <div class="live-time" id="liveTime">00:00:00</div>
  <div class="live-location" id="liveLocation">
    <span id="cityName"> city...</span>
  </div>

</div>
  <!-- Dashboard -->
  <div id="dashboard" class="card hide">
    <h1>السلام علیکم! <span id="displayName" style="font-weight:bold; color:#fff;"></span> 👋</h1>
    <img id="profilePic" src="" class="profile-pic" onclick="document.getElementById('picInput').click()" />
    <input type="file" id="picInput" accept="image/*" style="display:none" onchange="uploadProfilePic(this)" />
    <p><strong>Email:</strong> <span id="displayEmail"></span></p>

    <button class="small-btn" onclick="showProfile()">My Profile</button><button class="small-btn" onclick="showInformations()">Informations 📺</button>
    <button class="small-btn" onclick="showEditProfile()">Edit Profile ✏️</button>
    <button class="small-btn" onclick="showGroup()">Group & Updates (روز کی معلومات) </button>
    <button class="small-btn" onclick="showEntertainmentChat()">Entertainment Chat 💑</button>
    <!-- Ye line delete kar do -->
    <button class="small-btn" onclick="showChillWithFriends()">Chill with Friends (دوست بنائے) 👥</button>
    <button class="small-btn" onclick="showMyApps()">My Apps</button>
    <button class="small-btn" onclick="showSupport()">Support (ہم سے رابطہ)</button>
    <button class="small-btn" onclick="showComplaintHistory()">Complaint History (شکایات کی معلومات) </button>
    
    
    <button class="small-btn" onclick="showMovies()">Movies & Drama 🎬</button>


<button class="small-btn" onclick="showUserMovieHistory()">Movie & Drama History 📜</button>
  <button class="small-btn" onclick="showSocialWorld()">Social World 🌐</button>
  <button class="small-btn" onclick="showDepositFunds()">Deposit Funds 💸</button>
  <button class="small-btn" onclick="showSocialServices()">Social Services & Deposit 💰</button>
    <button class="small-btn" onclick="showFeedback()">Feedback & Ratings 🌟</button>
   <!-- Dashboard ke andar yeh button add kar dena -->
<button class="small-btn" onclick="showSimDetailsRequest()">SIM Details Request 📱</button>
   <button class="small-btn" onclick="showSimHistory()">SIM Requests History 📜</button>
   
    <button class="small-btn" onclick="showTrustPage()">About & Trust 🌟</button>
    <button class="small-btn" onclick="showContact()">Contact Us 📞</button>
    <button class="small-btn" onclick="showPolicy()">Policy & Guidelines 📜</button>
    <button class="small-btn" onclick="showShareFriends()">Share Friends & Earn 🌟</button>
   
    
    <button class="small-btn" style="background:#ff4494" onclick="logout()">Logout</button>
  </div>

  <!-- My Profile -->
  <div id="profilePage" class="card hide">
    <h1>My Profile</h1>
    <img id="bigPic" src="" class="profile-pic" onclick="document.getElementById('picInput2').click()" />
    <input type="file" id="picInput2" accept="image/*" style="display:none" onchange="uploadProfilePic(this)" />
    <p style="text-align:center; margin:10px 0; color:#ccc; font-size:13px;">Tap photo to change (max 5MB)</p>

    <div class="info-row"><strong>Username:</strong> <span id="profileName"></span></div>
    <div class="info-row"><strong>Email:</strong> <span id="profileEmail"></span></div>
    <div class="info-row password-wrapper">
      <strong>Password:</strong> 
      <span id="profilePass" style="margin-left:10px; letter-spacing:2px;">••••••••</span>
      <span class="eye" onclick="toggleProfilePass()">👁️</span>
    </div>

    <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
  </div>
<!-- Edit Profile Page - Naya Section -->
<div id="editProfilePage" class="card hide">
  <h1>Edit Profile ✏️</h1>

  <!-- Username Change -->
  <input type="text" id="editUsername" placeholder="New Username" />

  <!-- WhatsApp Bind -->
  <input type="text" id="editWhatsapp" placeholder="WhatsApp Number (03XXXXXXXXX)" maxlength="11" />

  <!-- Address Add -->
  <textarea id="editAddress" placeholder="Your Full Address (City, Street, House No.)" rows="4"></textarea>

  <!-- Total Old Customers -->
  <div style="text-align:center; margin:30px 0; padding:20px; background:rgba(255,255,255,0.1); border-radius:16px;">
    <p style="font-size:18px; opacity:0.9;">MrCrazyTeam ke Total Old Customers</p>
    <p id="totalCustomers" style="font-size:36px; font-weight:bold; color:var(--primary); margin-top:10px;">0</p>
  </div>

  <button onclick="saveProfileChanges()">Save Changes 💾</button>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
  <!-- Support -->
  <div id="supportPage" class="card hide">
    <h1>Support (ہم سے رابطہ)</h1>
    <button class="small-btn" onclick="showComplaintForm()">File Complaint (شکایات جمع کریں) </button>
    <button class="small-btn" onclick="showLiveChat()">Live Chat with MrCrazyTeam</button>
    <div class="link" onclick="showDashboard()">← Back</div>
  </div>

  <!-- File Complaint -->
  <div id="complaintForm" class="card hide">
    <h1>File Complaint</h1>
    <input type="text" id="compName" placeholder="Your Name" readonly />
    <input type="email" id="compEmail" placeholder="Your Email" readonly />
    <textarea id="compDesc" placeholder="Describe your problem in (اپنی شکایات تفصیل سے لکھیں) " rows="5"></textarea>

    <div style="margin:15px 0;">
      <button type="button" onclick="document.getElementById('compImage').click()" style="width:auto; padding:10px 15px; background:rgba(255,255,255,0.2);">
         
         
      </button>
      <input type="file" id="compImage" accept="image/*" style="display:none" onchange="previewImage(this)" />
      <div id="loadingText" class="loading hide">Uploading... ⏳</div>
      <div id="imagePreview" class="preview-box hide">
        <img id="previewImg" class="preview-img" />
        <div class="remove-img" onclick="removeImage()">✕</div>
      </div>
    </div>

    <button onclick="submitComplaint()">Submit Complaint</button>
    <div class="link" onclick="showSupport()">← Back</div>
  </div>
  <!-- Informations Section - Admin Videos List -->
<div id="informationsPage" class="card hide">
  <h1>Informations 📺</h1>
  <div id="infoList" style="margin:20px 0; max-height:60vh; overflow-y:auto;"></div>
  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
  <!-- Naya Section: Check History Page -->
<div id="checkHistoryPage" class="card hide">
  <h1>Check History 🌟</h1>
  
  <!-- Auto Greet -->
  <div id="greetSection" class="greet-card">
    <div class="greet-icon">🤝</div>
    <p id="greetMsg">Assalam o Alaikum!</p>
  </div>

  <!-- Language Select -->
  <div id="langSection" class="lang-container">
    <p style="text-align:center; opacity:0.9; margin-bottom:15px;">Please select your language</p>
    <button class="lang-btn" onclick="selectLanguage('English')">English 🇺🇸</button>
  </div>

  <!-- Loading Spinner -->
  <div id="loadingSection" class="hide">
    <div class="loading-card">
      <div class="spinner">⏳</div>
      <p>Loading options...</p>
    </div>
  </div>

  <!-- Options Section (Hidden Initially) -->
  <div id="optionsSection" class="hide">
    <h2 style="text-align:center; color:var(--ramzan-gold); margin-bottom:20px;">What would you like to check?</h2>
    <div class="options-grid">
      <button class="option-btn" onclick="showComplaintCheck()">Check Complaint 📝</button>
      <button class="option-btn" onclick="showGetApp()">Get App 📱</button>
      <button class="option-btn" onclick="showMovieCheck()">Check Movie & Drama 🎬</button>
    </div>
  </div>

  <!-- Complaint Check Form -->
  <div id="complaintCheckForm" class="hide">
    <h2>Check Complaint</h2>
    <input type="text" id="complaintId" placeholder="Please enter complaint ID (e.g., CMP-12345678)" />
    <button onclick="checkComplaint()">Check Now</button>
    <div id="complaintResult"></div>
  </div>

  <!-- Get App Form -->
  <div id="getAppForm" class="hide">
    <h2>Get App</h2>
    <input type="text" id="appName" placeholder="Please enter App name" />
    <button onclick="requestApp()">Send Request</button>
    <div id="appResult"></div>
  </div>

  <!-- Movie Check Form -->
  <div id="movieCheckForm" class="hide">
    <h2>Check Movie & Drama</h2>
    <input type="text" id="movieReqName" placeholder="Please enter your movie name jo ap ne req ki ha" />
    <button onclick="checkMovieRequest()">Check Status</button>
    <div id="movieResult"></div>
  </div>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- User Movie & Drama History - Slim Ramzan VIP (User-Only View) -->
<div id="userMovieHistoryPage" class="card hide">
  <h1>My Movie & Drama History 📜</h1>
  
  <div class="history-container">
    <div id="userMovieHistoryList"></div>
  </div>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- Naya Section: Movies & Drama Page -->
<div id="moviesPage" class="card hide">
  <h1>Movies & Drama 🌟</h1>
  
  <!-- Selection: Drama or Film -->
  <div id="selectionSection" class="selection-container">
    <div class="selection-grid">
      <button class="select-btn" onclick="selectType('Drama')">Drama 📺</button>
      <button class="select-btn" onclick="selectType('Film')">Film 🎥</button>
    </div>
    <p style="text-align:center; opacity:0.8; margin-top:15px; font-size:14px;">Select Drama or Film to request</p>
  </div>

  <!-- Form: Hidden Initially -->
  <div id="requestForm" class="hide">
    <h2 id="formTitle" style="text-align:center; margin-bottom:20px; color:var(--ramzan-gold);">Request Your Favorite</h2>
    <input type="text" id="movieName" placeholder="Please enter full movie name" />
    <input type="text" id="whatsappNum" placeholder="Please enter WhatsApp number (03XXXXXXXXX)" maxlength="11" />
    <button onclick="submitMovieRequest()">Submit Request</button>
  </div>

  <!-- Success Message: Hidden Initially -->
  <div id="successSection" class="hide">
    <div class="success-card">
      <div class="success-icon">✅</div>
      <p>This film or drama will be sent to your WhatsApp number soon.</p>
      <p style="font-weight:bold; color:var(--ramzan-gold);">Your request is being processed by MrCrazyTeam.</p>
      <div class="chand-sparkle">☾</div>
    </div>
    <div class="link" onclick="showMovies()">← Request Another</div>
  </div>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- New Premium Banking Style Feedback Section -->
<div id="feedbackPage" class="card hide">
  <h1>Rate Your Experience</h1>
  
  <div class="banking-feedback">
    <div class="rating-section">
      <div class="stars-large">
        <span class="star-large" onclick="setRating(1)">★</span>
        <span class="star-large" onclick="setRating(2)">★</span>
        <span class="star-large" onclick="setRating(3)">★</span>
        <span class="star-large" onclick="setRating(4)">★</span>
        <span class="star-large" onclick="setRating(5)">★</span>
      </div>
      <p id="ratingTextLarge" class="rating-text">Tap a star to rate</p>
    </div>

    <textarea id="feedbackText" placeholder="Share your thoughts (optional)..." rows="4"></textarea>

    <button onclick="submitFeedback()" class="submit-btn">Submit Feedback</button>
  </div>

  <div class="feedback-history">
    <h3 style="margin:20px 0 10px; font-size:18px; color:var(--primary);">Recent Feedback</h3>
    <div id="feedbackList"></div>
  </div>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- SIM Details Request Page -->
<div id="simDetailsPage" class="card hide">
  <h1>SIM Details Request</h1>

  <div style="text-align:center; margin:20px 0; padding:20px; background:rgba(255,255,255,0.08); border-radius:16px;">
    <h2 style="color:var(--primary); margin-bottom:15px;">
      Hey 👋 <span id="simUserName"></span> We're here
    </h2>
    <p style="font-size:16px; opacity:0.9;">
     📲 Required Information
Please enter the mobile number or CNIC of the person whose data you wish to obtain. 📝
Thank you
    </p>
  </div>

  <input type="text" id="simQueryInput" placeholder="Enter Mobile Number or CNIC (without dashes)" maxlength="20" />
  
  <textarea id="simReason" placeholder="Please provide a valid reason for this request to proceed further. 📝)" rows="3" style="margin:15px 0;"></textarea>

  <button onclick="submitSimRequest()">Submit Request</button>

  <div id="simResult" style="margin-top:20px; text-align:center;"></div>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- SIM Requests History Page -->
<div id="simHistoryPage" class="card hide">
  <h1>SIM Requests History 📜</h1>
  
  <div class="history-container">
    <div id="simHistoryList"></div>
  </div>

  <!-- No history message -->
  <div id="noSimHistory" class="no-history hide">
    <p>Aap ne abhi tak koi SIM details request nahi ki 📭</p>
    <p>Request karne ke liye SIM Details Request section use karen.</p>
  </div>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- Deposit Funds Section - Fixed Typing & Fast Messages -->
<div id="depositFundsPage" class="card hide">
  <h1>Deposit Funds 💸</h1>
  
  <div class="deposit-chat-box" id="depositChatBox"></div>
  
  <div class="deposit-methods hide" id="depositMethods">
    <button class="method-btn" onclick="startDepositMethod('jazzcash')">JazzCash</button>
    <button class="method-btn" onclick="startDepositMethod('sadapay')">SadaPay</button>
    <button class="method-btn" onclick="startDepositMethod('manual')">Manual Add</button>
  </div>
  
  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- Fresh Social Services & Deposit Section -->
<div id="socialServicesPage" class="card hide">
  <h1>Social Services & Deposit 💰</h1>
  
  <div class="service-tabs">
    <button class="tab-btn active" onclick="switchTab('services')">Services</button>
    <button class="tab-btn" onclick="switchTab('deposit')">Deposit Cash</button>
    <button class="tab-btn" onclick="switchTab('history')">History</button>
  </div>
  
<!-- Services Tab -->
<div id="services" class="tab-content active">
  <div class="balance-header">
    <strong>Your Balance:</strong> <span id="currentBalance">Rs. 0.00</span>
  </div>
  
  <h2>Services</h2>
  <div id="slimServicesList" class="slim-list"></div>
  
  <div id="serviceOrderForm" class="hide">
    <h3 id="formServiceTitle"></h3>
    <p id="formServiceDesc"></p>
    <p><strong>Rate:</strong> Rs. <span id="ratePer1000">165</span> per 1000</p>
    
    <input type="text" id="orderLink" placeholder="Video / Post Link" />
    <input type="number" id="orderQty" placeholder="Quantity" min="1" oninput="calcServiceTotal()" />
    <p><strong>Total Amount:</strong> Rs. <span id="orderTotal">0.00</span></p>
    
    <button onclick="placeOrderWithDeduct()">Place Order</button>
    <button class="back" onclick="hideOrderForm()">Back to List</button>
  </div>
</div>
  <!-- Deposit Tab (simple placeholder – agar pehle wala chahiye to bata dena) -->
  <div id="deposit" class="tab-content">
    <h2>Deposit Cash</h2>
    <p style="text-align:center; padding:40px; opacity:0.8;">
      Deposit options jald aa rahe hain...<br>
      Abhi JazzCash / SadaPay / Manual ke liye admin se rabta karen.
    </p>
  </div>
  
  <!-- History Tab -->
  <div id="history" class="tab-content">
    <h2>Your Order History</h2>
    <div id="userHistoryList"></div>
  </div>
  
  <div class="back-link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- Share Friends Section -->
<div id="shareFriendsPage" class="card hide">
  <h1>Share Friends 🌟</h1>
  
  <div class="share-container">
    <div class="share-greeting">
      <div class="share-icon">🚀</div>
      <h2>Dost ko invite karo!</h2>
      <p>Apne doston ko MrCrazyTeam app share karo aur community ko grow karo ❤️</p>
    </div>

    <div class="share-link-box">
      <div class="share-link">
        https://mrcrazy7778.netlify.app/
      </div>
      
      <div class="share-buttons">
        <button class="share-btn whatsapp" onclick="shareViaWhatsApp()">
          <span>WhatsApp pe Share</span> 📱
        </button>
        
        <button class="share-btn copy" onclick="copyAppLink()">
          <span>Copy Link</span> 📋
        </button>
      </div>
    </div>

    <div id="shareResult" class="share-result hide"></div>
  </div>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
<!-- Social World Section - Sirf Balance Dikhega -->
<div id="socialWorldPage" class="card hide">
  <h1>Social World 🌐</h1>

  <div class="social-balance-board">
    <div class="balance-title">Aapka Current Balance</div>
    <div class="balance-value" id="userBalanceAmount">Rs. 0</div>
    <div class="balance-note">
      <p>Your total balance</p>
      <p>To add balance, please click on the ‘Deposit Funds’ option.</p>
    </div>
  </div>

  <div class="social-placeholder">
    <p style="text-align:center; opacity:0.7; margin-top:30px;">
      Zyada features jald aa rahe hain... Stay tuned! ✨
    </p>
  </div>

  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>
  <!-- Policy & Guidelines Section -->
  <div id="policyPage" class="card hide">
    <h1>Policy & Guidelines 📜</h1>

    <div class="policy-container">

      <div class="policy-header">
        <h2>Community Guidelines</h2>
        <p>We believe in a safe, respectful and fun community ❤️</p>
      </div>

      <div class="guideline-item">
        <div class="guideline-number">01</div>
        <div class="guideline-text">
          <strong>Be Respectful</strong><br>
          No hate speech, harassment, bullying or personal attacks allowed.
        </div>
      </div>

      <div class="guideline-item">
        <div class="guideline-number">02</div>
        <div class="guideline-text">
          <strong>No Spam or Scam</strong><br>
          No promotional links, fake giveaways or fraudulent activities.
        </div>
      </div>

      <div class="guideline-item">
        <div class="guideline-number">03</div>
        <div class="guideline-text">
          <strong>Keep it Clean</strong><br>
          No adult content, violence or illegal discussions.
        </div>
      </div>

      <div class="guideline-item">
        <div class="guideline-number">04</div>
        <div class="guideline-text">
          <strong>Privacy First</strong><br>
          Never share personal information of others without permission.
        </div>
      </div>

      <div class="guideline-item">
        <div class="guideline-number">05</div>
        <div class="guideline-text">
          <strong>Follow Rules</strong><br>
          Violation of any rule may result in warning or permanent ban.
        </div>
      </div>

      <div class="ceo-section">
        <div class="ceo-photo">
          <div class="ceo-avatar">👑</div>
        </div>
        <div class="ceo-info">
          <h3>Founder & CEO</h3>
          <h2>Muhammad Naeem</h2>
          <p>Leading MrCrazyTeam with passion & dedication since day one ❤️</p>
        </div>
      </div>

      <div class="policy-footer">
        <p>Thank you for being part of our community</p>
        <p><strong>MrCrazyTeam</strong> — Built with love & trust</p>
      </div>

    </div>

    <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
  </div>
<!-- Chill with Friends Main Page -->
<div id="chillPage" class="card hide">
  <h1>Chill with Friends 👥</h1>
  <!-- Report User Modal -->
<div id="reportModal" class="modal hide">
  <div class="modal-content" style="max-width:95%;">
    <span class="close-modal" onclick="closeReportModal()">×</span>
    <h2>Report User ⚠️</h2>
    <p><strong>Reporting:</strong> <span id="reportTargetName"></span></p>
    <textarea id="reportReason" placeholder="Issue/reason detail mein likho..." rows="6" style="width:100%; padding:12px; border-radius:12px; background:rgba(255,255,255,0.1); color:white; border:none; margin:15px 0;"></textarea>
    <button onclick="submitUserReport()" style="background:#ff4444;">Submit Report</button>
  </div>
</div>
  <div class="trust-container" style="gap:15px; margin-top:20px;">
    <button class="small-btn" onclick="showMrCrazyUsers()" style="width:100%; padding:15px; font-size:16px;">MrCrazy Users 👥</button>
    <button class="small-btn" onclick="showFriendRequests()" style="width:100%; padding:15px; font-size:16px;">Friend Requests 📥 <span id="requestCountBadge" class="status pending hide">0</span></button>
    <button class="small-btn" onclick="showFriendsChat()" style="width:100%; padding:15px; font-size:16px;">Friends & Chat 💬</button>
  </div>
  
  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>

<!-- MrCrazy Users List -->
<div id="mrcrazyUsersPage" class="card hide">
  <h1>MrCrazy Users 👥</h1>
  <div id="allUsersList" style="margin-top:20px;"></div>
  <div class="link" onclick="showChillWithFriends()">← Back</div>
</div>

<!-- Friend Requests -->
<div id="friendRequestsPage" class="card hide">
  <h1>Friend Requests 📥</h1>
  <div id="incomingRequests"></div>
  <div id="outgoingRequests" style="margin-top:30px;">
    <h3>Sent Requests</h3>
    <div id="sentRequestsList"></div>
  </div>
  <div class="link" onclick="showChillWithFriends()">← Back</div>
</div>

<!-- Friends & Private Chat -->
<div id="friendsChatPage" class="card hide">
  <h1>My Friends 💬</h1>
  <div id="friendsList" style="margin:20px 0;"></div>
  <div class="link" onclick="showChillWithFriends()">← Back</div>
</div>

<!-- Private Chat Window -->
<div id="privateChatModal" class="modal hide">
  <div class="modal-content" style="max-width:95%; height:90vh; display:flex; flex-direction:column;">
    <div style="display:flex; justify-content:space-between; align-items:center; padding:10px; border-bottom:1px solid rgba(255,255,255,0.2);">
      <h2 id="chatWithUser"></h2>
      <span class="close-modal" onclick="closePrivateChat()">×</span>
    </div>
    <div id="privateMessages" class="entertainment-container" style="flex:1; overflow-y:auto;"></div>
    <div class="chat-input" style="padding:10px; background:rgba(0,0,0,0.3);">
      <input type="text" id="privateMsgInput" placeholder="Type a message..." onkeydown="if(event.key==='Enter') sendPrivateMessage()" />
      <button onclick="sendPrivateMessage()">Send</button>
    </div>
  </div>
</div>
 <!-- New Mobile-First Entertainment Chat -->
<div id="entertainmentPage" class="card hide">
  <h1>Entertainment Chat 🎉</h1>
  
  <div id="entChatContainer" class="ent-chat-container">
    <!-- Messages yahan dynamically aayenge -->
  </div>
  
  <div class="ent-input-bar">
    <button class="ent-attach" onclick="document.getElementById('entImageUpload').click()">📎</button>
    <input type="text" id="entChatInput" placeholder="Type a message..." onkeydown="if(event.key==='Enter') sendEntMessage()" />
    <button class="ent-send" onclick="sendEntMessage()">Send</button>
  </div>
  
  <input type="file" id="entImageUpload" accept="image/*" style="display:none" onchange="sendEntImage(this)" />
  
  <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
</div>

  <!-- Contact Us Section -->
  <div id="contactPage" class="card hide">
    <h1>Contact Us 📞</h1>

    <div class="contact-box">
      <div class="contact-item">
        <div class="contact-icon">📧</div>
        <div class="contact-title">Email Us</div>
        <div class="contact-detail">MrCrazyTeamofficial@gmail.com</div>
        <div class="contact-note">24/7 Support Available</div>
      </div>

      <div class="contact-item">
        <div class="contact-icon">🌐</div>
        <div class="contact-title">Our Website</div>
        <a href="https://MrCrazy7778.taplink.ws" target="_blank" class="contact-link">MrCrazy7778.taplink.ws</a>
      </div>

      <div class="contact-item">
        <div class="contact-icon">💬</div>
        <div class="contact-title">WhatsApp Channel</div>
        <a href="https://whatsapp.com/channel/0029VbBwFGO9Bb5s9beJ201f" target="_blank" class="contact-link">
          Join Our Channel
        </a>
        <div class="contact-note">Your number will NEVER be shown to anyone 🔒</div>
      </div>

      <div class="contact-item coming-soon">
        <div class="contact-icon">📱</div>
        <div class="contact-title">Direct WhatsApp</div>
        <div class="contact-detail">Coming Soon...</div>
      </div>
    </div>



    <div class="contact-footer">
      <p>We reply as fast as possible ❤️</p>
      <p>Made with love by <strong>MRCRAZYTEAM</strong></p>
    </div>

    <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
  </div>

  <!-- Group & Updates Section -->
  <div id="groupPage" class="card hide">
    <h1>Group & Updates 👥</h1>
    <div style="text-align:center; margin:20px 0; padding:15px; background:rgba(255,255,255,0.1); border-radius:12px;">
      <p style="font-size:18px; opacity:0.8;">Total Members in Group</p>
      <p id="totalUsersCount" style="font-size:32px; font-weight:bold; color:var(--primary);">0</p>
    </div>
    <div id="updatesList" style="margin-top:20px;"></div>
    <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
  </div>

  <!-- My Apps - Fixed Full List + Details on Click -->
  <div id="myAppsPage" class="card hide">
    <h1>My Apps 📱</h1>
    <div id="appsList"></div>
    <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
  </div>

  <!-- App Details Modal -->
  <div id="appDetailsModal" class="modal hide">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">×</span>
      <div id="appDetails"></div>
    </div>
  </div>

  <!-- Complaint History -->
  <div id="historyPage" class="card hide">
    <h1>Complaint History</h1>
    <div id="complaintsList"></div>
    <div class="link" onclick="showDashboard()">← Back</div>
  </div>

  <!-- Live Chat - Fixed Left/Right -->
  <div id="chatPage" class="card hide">
    <h1>Live Chat with MrCrazyTeam 💬</h1>
    <div id="chatContainer" class="chat-container"></div>
    <div class="chat-input">
      <button onclick="document.getElementById('chatImage').click()">📷</button>
      <input type="text" id="chatMsg" placeholder="Type your message..." onkeydown="if(event.key==='Enter') sendChatMessage()" />
      <button onclick="sendChatMessage()">Send</button>
    </div>
    <input type="file" id="chatImage" accept="image/*" style="display:none" onchange="sendChatImage(this)" />
    <div class="link" onclick="showSupport()">← Back</div>
  </div>

  <!-- About & Trust Page -->
  <div id="trustPage" class="card hide">
    <h1>About & Trust 🌟</h1>

    <div class="trust-container">
      <div class="trust-item">
        <div class="trust-icon">🔒</div>
        <div class="trust-title">100% Password Safe</div>
        <div class="trust-desc">We never ask for your passwords or store them. Your account is fully secure with Firebase Authentication.</div>
      </div>

      <div class="trust-item">
        <div class="trust-icon">📧</div>
        <div class="trust-title">Real Support</div>
        <div class="trust-desc">Live Chat with Admin available 24/7. Real humans, real help – no bots!</div>
      </div>

      <div class="trust-item">
        <div class="trust-icon">🛡️</div>
        <div class="trust-title">Safe & Secure</div>
        <div class="trust-desc">All data encrypted. Screenshot & recording blocked. Your privacy is our priority.</div>
      </div>

      <div class="trust-item">
        <div class="trust-icon">💬</div>
        <div class="trust-title">Community First</div>
        <div class="trust-desc">Entertainment Chat, Group Updates, Feedback – everything made for real users by real team.</div>
      </div>
    </div>

    <div class="trust-footer">
      <p>Made with ❤️ by</p>
      <h3>MRCRAZYTEAM</h3>
    </div>

    <div class="link" onclick="showDashboard()">← Back to Dashboard</div>
  </div>
</div>


<!-- Small Animated WhatsApp Floating Icon -->
<a href="https://wa.me/9779761970136?text=Hi%20MrCrazyTeam%20Please%20help%20me!" 
   target="_blank" 
   id="whatsappFloatBtn" 
   title="Help? Chat with MrCrazyTeam">
  <div class="wa-icon-container">
    <div class="wa-icon">WA</div>
  </div>
</a>
</body>
</html>
<script>
  const firebaseConfig = {
  apiKey: "AIzaSyD3uBXUfhb6yG0ScWjXKf3DV-rpG_1fmaI",
  authDomain: "crazy-9a4d8.firebaseapp.com",
  databaseURL: "https://crazy-9a4d8-default-rtdb.firebaseio.com",
  projectId: "crazy-9a4d8",
  storageBucket: "crazy-9a4d8.appspot.com",
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();
const storage = firebase.storage();
let currentUser = null;
let selectedFile = null;

auth.onAuthStateChanged(user => {
  if (user) {
    currentUser = user;
    loadUserData(user);
    showDashboard();
    checkNotifications();
  } else {
    showLogin();
    currentUser = null;
  }
});

function togglePass(id) {
  const f = document.getElementById(id);
  f.type = f.type === "password" ? "text" : "password";
}

function toggleProfilePass() {
  const passField = document.getElementById('profilePass');
  if (passField.textContent === "••••••••") {
    passField.textContent = "[Hidden for security]";
  } else {
    passField.textContent = "••••••••";
  }
}

function showLogin() { hideAll(); document.getElementById('loginPage').classList.remove('hide'); }
function showSignup() { hideAll(); document.getElementById('signupPage').classList.remove('hide'); }
function showForgot() { hideAll(); document.getElementById('forgotPage').classList.remove('hide'); }
function showDashboard() { hideAll(); document.getElementById('dashboard').classList.remove('hide'); }
function showProfile() { hideAll(); document.getElementById('profilePage').classList.remove('hide'); loadProfile(); }
function showSupport() { hideAll(); document.getElementById('supportPage').classList.remove('hide'); }
function showComplaintForm() { 
  hideAll(); 
  document.getElementById('complaintForm').classList.remove('hide'); 
  document.getElementById('compName').value = currentUser.displayName || "User";
  document.getElementById('compEmail').value = currentUser.email;
  document.getElementById('compDesc').value = "";
  document.getElementById('imagePreview').classList.add('hide');
  selectedFile = null;
}
function showComplaintHistory() { hideAll(); document.getElementById('historyPage').classList.remove('hide'); loadComplaints(); }
function showLiveChat() { hideAll(); document.getElementById('chatPage').classList.remove('hide'); loadPrivateChat(); }
function showGroup() { hideAll(); document.getElementById('groupPage').classList.remove('hide'); loadTotalUsers(); loadUpdates(); }
function showMyApps() { hideAll(); document.getElementById('myAppsPage').classList.remove('hide'); loadAppsList(); }

function hideAll() {
  document.querySelectorAll('.card').forEach(c => c.classList.add('hide'));
}

function signup() {
  const username = document.getElementById('username').value.trim();
  const email = document.getElementById('signupEmail').value.trim();
  const pass = document.getElementById('signupPass').value;
  const confirm = document.getElementById('confirmPass').value;

  if (pass !== confirm) return alert("Passwords don't match!");
  if (!username || !email || !pass) return alert("Fill all fields!");

  auth.createUserWithEmailAndPassword(email, pass)
    .then(cred => {
      return db.ref('users/' + cred.user.uid).set({
        username: username,
        email: email,
        photoURL: "",
        createdAt: Date.now()
      });
    })
    .then(() => alert("Account created successfully! 😍"))
    .catch(err => alert(err.message));
}

function login() {
  const email = document.getElementById('loginEmail').value;
  const pass = document.getElementById('loginPass').value;
  auth.signInWithEmailAndPassword(email, pass).catch(err => alert(err.message));
}

function showTrustPage() {
  hideAll();
  document.getElementById('trustPage').classList.remove('hide');
}

function forgotPass() {
  const email = document.getElementById('forgotEmail').value;
  if (!email) return alert("Enter email!");
  auth.sendPasswordResetEmail(email)
    .then(() => alert("Reset link sent to your email! 📧"))
    .catch(err => alert(err.message));
}

function logout() {
  auth.signOut();
}

function loadUserData(user) {
  db.ref('users/' + user.uid).once('value').then(snap => {
    const data = snap.val() || {};
    document.getElementById('displayName').textContent = data.username || "User";
    document.getElementById('displayEmail').textContent = data.email || user.email;

    const picUrl = data.photoURL || `https://ui-avatars.com/api/?name=${data.username || "U"}&background=6a4cff&color=fff&size=128`;
    document.getElementById('profilePic').src = picUrl;
  });
}

function loadProfile() {
  db.ref('users/' + currentUser.uid).once('value').then(snap => {
    const data = snap.val() || {};
    document.getElementById('profileName').textContent = data.username || "User";
    document.getElementById('profileEmail').textContent = data.email || currentUser.email;

    const picUrl = data.photoURL || `https://ui-avatars.com/api/?name=${data.username || "U"}&background=6a4cff&color=fff&size=256`;
    document.getElementById('bigPic').src = picUrl;
  });
}
// Show Edit Profile Page
function showEditProfile() {
  hideAll();
  document.getElementById('editProfilePage').classList.remove('hide');
  loadEditProfileData();
  loadTotalCustomers();
}

// Load Current Data in Edit Fields
function loadEditProfileData() {
  db.ref('users/' + currentUser.uid).once('value').then(snap => {
    const data = snap.val() || {};
    document.getElementById('editUsername').value = data.username || "";
    document.getElementById('editWhatsapp').value = data.whatsapp || "";
    document.getElementById('editAddress').value = data.address || "";
  });
}

// Load Total Customers (Total Registered Users)
function loadTotalCustomers() {
  db.ref('users').on('value', snap => {
    const count = snap.numChildren();
    document.getElementById('totalCustomers').textContent = count;
  });
}
// Show Team Members Section
function showMembers() {
  hideAll();
  document.getElementById('membersPage').classList.remove('hide');
}
// Save Changes
function saveProfileChanges() {
  const newUsername = document.getElementById('editUsername').value.trim();
  const whatsapp = document.getElementById('editWhatsapp').value.trim();
  const address = document.getElementById('editAddress').value.trim();

  if (!newUsername) {
    return alert("Username khali nahi ho sakta!");
  }

  if (whatsapp && (whatsapp.length !== 11 || !whatsapp.startsWith('03'))) {
    return alert("Valid WhatsApp number daalen (03XXXXXXXXX)");
  }

  db.ref('users/' + currentUser.uid).update({
    username: newUsername,
    whatsapp: whatsapp,
    address: address
  }).then(() => {
    alert("Profile successfully updated! 🔥");
    
    // Dashboard pe username update ho jaye
    loadUserData(currentUser);
    
    // Agar chahte ho auth displayName bhi update ho
    // currentUser.updateProfile({ displayName: newUsername });
  }).catch(err => {
    alert("Error: " + err.message);
  });
}
function uploadProfilePic(input) {
  const file = input.files[0];
  if (!file) return;
  if (file.size > 5 * 1024 * 1024) return alert("Image must be under 5MB!");

  const ref = storage.ref('profile_pics/' + currentUser.uid);
  ref.put(file).then(() => {
    ref.getDownloadURL().then(url => {
      db.ref('users/' + currentUser.uid).update({ photoURL: url });
      alert("Profile picture updated! 🔥");
    });
  });
}

function showPolicy() {
  hideAll();
  document.getElementById('policyPage').classList.remove('hide');
}

function previewImage(input) {
  const file = input.files[0];
  if (!file) return;
  if (file.size > 5 * 1024 * 1024) return alert("Image must be under 5MB!");
  selectedFile = file;

  const reader = new FileReader();
  reader.onload = function(e) {
    document.getElementById('previewImg').src = e.target.result;
    document.getElementById('imagePreview').classList.remove('hide');
  }
  reader.readAsDataURL(file);
}

let entertainmentReplyingTo = null;
// Chill with Friends Features
function showChillWithFriends() {
  hideAll();
  document.getElementById('chillPage').classList.remove('hide');
  updateRequestBadge();
}

function showMrCrazyUsers() {
  hideAll();
  document.getElementById('mrcrazyUsersPage').classList.remove('hide');
  loadAllUsers();
}
// Show Check History Section
function showCheckHistory() {
  hideAll();
  document.getElementById('checkHistoryPage').classList.remove('hide');
  document.getElementById('greetSection').classList.remove('hide');
  document.getElementById('langSection').classList.remove('hide');
  document.getElementById('loadingSection').classList.add('hide');
  document.getElementById('optionsSection').classList.add('hide');
  document.getElementById('complaintCheckForm').classList.add('hide');
  document.getElementById('getAppForm').classList.add('hide');
  document.getElementById('movieCheckForm').classList.add('hide');
  
  // Auto Greet
  db.ref('users/' + currentUser.uid).once('value').then(snap => {
    const data = snap.val() || {};
    document.getElementById('greetMsg').textContent = `Assalam o Alaikum ${data.username || 'User'}!`;
  });
}

// Select Language (Only English)
function selectLanguage(lang) {
  document.getElementById('langSection').classList.add('hide');
  document.getElementById('loadingSection').classList.remove('hide');
  
  setTimeout(() => {
    document.getElementById('loadingSection').classList.add('hide');
    document.getElementById('optionsSection').classList.remove('hide');
  }, 2000);  // 2 sec loading
}

// Show Sub-Forms
function showComplaintCheck() {
  hideOptions();
  document.getElementById('complaintCheckForm').classList.remove('hide');
  document.getElementById('complaintId').focus();
}

function showGetApp() {
  hideOptions();
  document.getElementById('getAppForm').classList.remove('hide');
  document.getElementById('appName').focus();
}

function showMovieCheck() {
  hideOptions();
  document.getElementById('movieCheckForm').classList.remove('hide');
  document.getElementById('movieReqName').focus();
}

function hideOptions() {
  document.getElementById('optionsSection').classList.add('hide');
  document.getElementById('complaintCheckForm').classList.add('hide');
  document.getElementById('getAppForm').classList.add('hide');
  document.getElementById('movieCheckForm').classList.add('hide');
}

// Back to Options (Optional - add in HTML if needed)
function backToOptions() {
  document.getElementById('optionsSection').classList.remove('hide');
  document.getElementById('complaintCheckForm').classList.add('hide');
  document.getElementById('getAppForm').classList.add('hide');
  document.getElementById('movieCheckForm').classList.add('hide');
}

// Check Complaint
function checkComplaint() {
  const id = document.getElementById('complaintId').value.trim();
  if (!id || !id.startsWith('CMP-')) {
    alert("Valid Complaint ID daalen (e.g., CMP-12345678)");
    return;
  }
  
  const result = document.getElementById('complaintResult');
  result.innerHTML = '<p>Loading...</p>';
  
  db.ref('complaints').orderByChild('complaintId').equalTo(id).once('value').then(snap => {
    if (!snap.val()) {
      result.innerHTML = '<p style="color:#ff4444;">Complaint not found!</p>';
      return;
    }
    
    snap.forEach(child => {
      const c = child.val();
      result.innerHTML = `
        <p><strong>Status:</strong> <span class="status ${c.status}">${c.status.toUpperCase()}</span></p>
        ${c.mrcrazyteamReply ? `<p><strong>Reply:</strong> ${c.mrcrazyteamReply}</p>` : '<p>No reply yet</p>'}
        <small>Submitted: ${new Date(c.timestamp).toLocaleString()}</small>
      `;
    });
  });
}

// Request App (Send to Admin)
function requestApp() {
  const appName = document.getElementById('appName').value.trim();
  if (!appName) {
    alert("Please enter App name!");
    return;
  }
  
  db.ref('appGetRequests').push({
    appName: appName,
    uid: currentUser.uid,
    username: currentUser.displayName || "User",
    timestamp: Date.now(),
    status: "pending"
  }).then(() => {
    document.getElementById('appResult').innerHTML = '<div class="success-card"><p>Request sent to admin! You will get the app soon. ✅</p></div>';
  }).catch(err => {
    alert("Error: " + err.message);
  });
}
// Social World Page Open + Balance Load
function showSocialWorld() {
  hideAll();
  document.getElementById('socialWorldPage').classList.remove('hide');
  loadUserBalance();
}

// Real-time User Balance Load
function loadUserBalance() {
  if (!currentUser) {
    document.getElementById('userBalanceAmount').textContent = "Login karo pehle";
    return;
  }

  db.ref('users/' + currentUser.uid + '/balance').on('value', snap => {
    const bal = snap.val() || 0;
    document.getElementById('userBalanceAmount').textContent = `Rs. ${bal.toLocaleString('en-PK')}`;
  });
}
// Check Movie Request
function checkMovieRequest() {
  const movieName = document.getElementById('movieReqName').value.trim();
  if (!movieName) {
    alert("Please enter your movie name!");
    return;
  }
  
  document.getElementById('movieResult').innerHTML = `
    <div class="success-card">
      <p>Coming Soon! Your request for "${movieName}" is under process.</p>
      <p style="color:var(--ramzan-gold);">Stay tuned for updates from MrCrazyTeam.</p>
    </div>
  `;
}
function showFriendRequests() {
  hideAll();
  document.getElementById('friendRequestsPage').classList.remove('hide');
  loadFriendRequests();
}

function showFriendsChat() {
  hideAll();
  document.getElementById('friendsChatPage').classList.remove('hide');
  loadFriendsList();
}

function loadAllUsers() {
  const list = document.getElementById('allUsersList');
  list.innerHTML = "<p>Loading users...</p>";
  
  db.ref('users').once('value').then(snap => {
    list.innerHTML = "";
    snap.forEach(userSnap => {
      const user = userSnap.val();
      const uid = userSnap.key;
      
      if (uid === currentUser.uid) return;
      
      db.ref(`friends/${currentUser.uid}/${uid}`).once('value').then(friendSnap => {
        if (friendSnap.exists()) return;
        
        db.ref(`friendRequests/${uid}/${currentUser.uid}`).once('value').then(reqSnap => {
          const hasSent = reqSnap.exists();
          
          const div = document.createElement('div');
          div.className = "friend-item";
          
          const pic = user.photoURL || `https://ui-avatars.com/api/?name=${encodeURIComponent(user.username || 'U')}&background=6a4cff&color=fff&size=128`;
          
          div.innerHTML = `
            <div style="display:flex; align-items:center; gap:15px;">
              <img src="${pic}" style="width:50px; height:50px; border-radius:50%; border:3px solid var(--primary);">
              <strong style="font-size:18px;">${user.username || 'User'}</strong>
            </div>
            <button ${hasSent ? 'style="background:#ff8800;" onclick="cancelFriendRequest(\''+uid+'\')"' : 'onclick="sendFriendRequest(\''+uid+'\')"'}>
              ${hasSent ? 'Cancel' : 'Add Friend'}
            </button>
          `;
          list.appendChild(div);
        });
      });
    });
  });
}

// Send Friend Request
function sendFriendRequest(uid) {
  const data = {
    from: currentUser.uid,
    fromName: currentUser.displayName || "User",
    timestamp: Date.now()
  };
  db.ref(`friendRequests/${uid}/${currentUser.uid}`).set(data).then(() => {
    alert("Friend request sent!");
    loadAllUsers();
  });
}function updateRatingDisplay() {
  document.querySelectorAll('.star-large').forEach((star, index) => {
    if (index < currentRating) {
      star.classList.add('active');
    } else {
      star.classList.remove('active');
    }
  });

  const texts = ["", "Poor", "Fair", "Good", "Great", "Excellent!"];
  document.getElementById('ratingTextLarge').textContent = texts[currentRating] || "Tap a star to rate";
}

// Cancel Request
function cancelFriendRequest(uid) {
  db.ref(`friendRequests/${uid}/${currentUser.uid}`).remove().then(() => {
    alert("Request cancelled");
    loadAllUsers();
  });
}

// Load Friend Requests
function loadFriendRequests() {
  const incoming = document.getElementById('incomingRequests');
  const sent = document.getElementById('sentRequestsList');
  incoming.innerHTML = "<h3>Incoming Requests</h3>";
  sent.innerHTML = "";

  // Incoming
  db.ref(`friendRequests/${currentUser.uid}`).on('value', snap => {
    incoming.innerHTML = "<h3>Incoming Requests</h3>";
    if (!snap.val()) {
      incoming.innerHTML += "<p>No new requests</p>";
    }
    snap.forEach(req => {
      const r = req.val();
      const fromUid = req.key;
      db.ref('users/' + fromUid).once('value').then(u => {
        const user = u.val();
        const div = document.createElement('div');
        div.className = "request-item";
        div.innerHTML = `
          <strong>${user.username}</strong> sent you a friend request<br>
          <small>${new Date(r.timestamp).toLocaleString()}</small><br>
          <button onclick="acceptRequest('${fromUid}')" style="background:#00aa55;">Accept</button>
          <button onclick="rejectRequest('${fromUid}')" style="background:#aa0000;">Reject</button>
        `;
        incoming.appendChild(div);
      });
    });
  });

  // Outgoing
  db.ref('users').once('value').then(users => {
    users.forEach(userSnap => {
      const uid = userSnap.key;
      if (uid === currentUser.uid) return;
      db.ref(`friendRequests/${uid}/${currentUser.uid}`).once('value').then(req => {
        if (req.exists()) {
          const user = userSnap.val();
          const div = document.createElement('div');
          div.className = "request-item";
          div.innerHTML = `<strong>${user.username}</strong> ← You sent request`;
          sent.appendChild(div);
        }
      });
    });
  });
}

function acceptRequest(fromUid) {
  const myUid = currentUser.uid;
  db.ref(`friends/${myUid}/${fromUid}`).set({ timestamp: Date.now() });
  db.ref(`friends/${fromUid}/${myUid}`).set({ timestamp: Date.now() });
  db.ref(`friendRequests/${myUid}/${fromUid}`).remove();
  alert("Now you are friends! 🎉");
  loadFriendRequests();
}

function rejectRequest(fromUid) {
  db.ref(`friendRequests/${currentUser.uid}/${fromUid}`).remove();
  alert("Request rejected");
}

// Load Friends List
let currentChatFriend = null;

function loadFriendsList() {
  const list = document.getElementById('friendsList');
  list.innerHTML = "<p>Loading friends...</p>";

  db.ref(`friends/${currentUser.uid}`).once('value').then(snap => {
    list.innerHTML = "";
    if (!snap.val()) {
      list.innerHTML = "<p>No friends yet 😢<br>Add from MrCrazy Users!</p>";
      return;
    }

    snap.forEach(friend => {
      const friendUid = friend.key;
      db.ref('users/' + friendUid).once('value').then(u => {
        const user = u.val();
        const div = document.createElement('div');
        div.className = "friend-item";
        div.style.cursor = "pointer";
        div.onclick = () => openPrivateChat(friendUid, user.username || "User");
        div.innerHTML = `
          <div>
            <strong>${user.username || 'User'}</strong><br>
            <small>Last seen: few minutes ago</small>
          </div>
          <span>💬</span>
        `;
        list.appendChild(div);
      });
    });
  });
}
// Show Movies & Drama Section
function showMovies() {
  hideAll();
  document.getElementById('moviesPage').classList.remove('hide');
  document.getElementById('selectionSection').classList.remove('hide');
  document.getElementById('requestForm').classList.add('hide');
  document.getElementById('successSection').classList.add('hide');
  document.getElementById('movieName').value = "";
  document.getElementById('whatsappNum').value = "";
  let selectedType = null;
}

// Select Type (Drama or Film)
function selectType(type) {
  selectedType = type;
  document.getElementById('formTitle').textContent = `Request ${type}`;
  document.getElementById('selectionSection').classList.add('hide');
  document.getElementById('requestForm').classList.remove('hide');
  document.getElementById('movieName').focus();
}

// Submit Movie Request with Monthly Limit (3 per user per month)
function submitMovieRequest() {
  const movieName = document.getElementById('movieName').value.trim();
  const whatsapp = document.getElementById('whatsappNum').value.trim();
  
  if (!movieName) {
    alert("Please enter full movie name!");
    return;
  }
  
  if (!whatsapp || whatsapp.length !== 11 || !whatsapp.startsWith('03')) {
    alert("Valid WhatsApp number daalen (03XXXXXXXXX)");
    return;
  }
  
  // First, check monthly limit
  db.ref('movieRequests').orderByChild('uid').equalTo(currentUser.uid).once('value').then(snap => {
    const now = new Date();
    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1).getTime();
    const endOfMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0, 23, 59, 59).getTime();
    
    let monthlyCount = 0;
    snap.forEach(child => {
      const req = child.val();
      if (req.timestamp >= startOfMonth && req.timestamp <= endOfMonth) {
        monthlyCount++;
      }
    });
    
    if (monthlyCount >= 3) {
      alert("Dear valued Customer, Please be informed that your current plan allows for a maximum of 3 movies & dramas per month.We kindly suggest Placing your next request in the coming month.Thank you for a continued cooperate for understanding. 📅");
      return;
    }
    
    // If under limit, save the request
    db.ref('movieRequests').push({
      type: selectedType,
      movieName: movieName,
      whatsapp: whatsapp,
      uid: currentUser.uid,
      username: currentUser.displayName || "User",
      timestamp: Date.now(),
      status: "pending"
    }).then(() => {
      document.getElementById('requestForm').classList.add('hide');
      document.getElementById('successSection').classList.remove('hide');
    }).catch(err => {
      alert("Error: " + err.message);
    });
  }).catch(err => {
    alert("Error checking limit: " + err.message);
  });
}
function openPrivateChat(friendUid, friendName) {
  currentChatFriend = friendUid;
  document.getElementById('chatWithUser').textContent = "Chat with " + friendName;
  document.getElementById('privateChatModal').classList.remove('hide');
  document.getElementById('privateMessages').innerHTML = "";
  loadPrivateMessages(friendUid);
}

function closePrivateChat() {
  document.getElementById('privateChatModal').classList.add('hide');
  currentChatFriend = null;
}

function loadPrivateMessages(friendUid) {
  const chatId = [currentUser.uid, friendUid].sort().join('_');
  const container = document.getElementById('privateMessages');

  db.ref(`privateChats/${chatId}`).orderByChild('timestamp').on('value', snap => {
    container.innerHTML = "";
    snap.forEach(msg => {
      const m = msg.val();
      const isOwn = m.sender === currentUser.uid;

      const div = document.createElement('div');
      div.className = `private-msg ${isOwn ? 'own' : 'other'}`;
      div.innerHTML = `
        ${m.message}
        <div class="private-msg-time">${new Date(m.timestamp).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</div>
        ${isOwn && (Date.now() - m.timestamp < 120000) ? `<span class="msg-options">✏️🗑️</span>` : ''}
        ${isOwn ? `<div style="margin-top:5px; font-size:12px; cursor:pointer; color:#ff4444;" onclick="reportMessage('${msg.key}', '${chatId}')">Report</div>` : ''}
      `;

      if (isOwn && (Date.now() - m.timestamp < 120000)) {
        div.querySelector('.msg-options').innerHTML = `
          <span onclick="editPrivateMsg('${msg.key}', '${chatId}')">✏️</span>
          <span onclick="deletePrivateMsg('${msg.key}', '${chatId}')">🗑️</span>
        `;
      }

      container.appendChild(div);
    });
    container.scrollTop = container.scrollHeight;
  });
}

function sendPrivateMessage() {
  const input = document.getElementById('privateMsgInput');
  const msg = input.value.trim();
  if (!msg || !currentChatFriend) return;

  // Number detection warning
  if (/\d{11,}/.test(msg) || /03\d{9}/.test(msg)) {
    if (!confirm("⚠️ Sharing number is not allowed! Continue?")) return;
  }

  const chatId = [currentUser.uid, currentChatFriend].sort().join('_');
  db.ref(`privateChats/${chatId}`).push({
    sender: currentUser.uid,
    message: msg,
    timestamp: Date.now()
  });

  input.value = "";
}

function deletePrivateMsg(msgId, chatId) {
  if (confirm("Delete this message?")) {
    db.ref(`privateChats/${chatId}/${msgId}`).remove();
  }
}

function editPrivateMsg(msgId, chatId) {
  const newMsg = prompt("Edit message:");
  if (newMsg) {
    db.ref(`privateChats/${chatId}/${msgId}`).update({ message: newMsg });
  }
}

function reportMessage(msgId, chatId) {
  const reason = prompt("Report reason:\n1. Abusing\n2. Wrong chat\n3. Other");
  if (reason) {
    db.ref('reports/privateMessages').push({
      msgId, chatId, reason, reportedBy: currentUser.uid, timestamp: Date.now()
    });
    alert("Reported to admin!");
  }
}

function updateRequestBadge() {
  db.ref(`friendRequests/${currentUser.uid}`).once('value').then(snap => {
    const count = snap.numChildren();
    const badge = document.getElementById('requestCountBadge');
    if (count > 0) {
      badge.textContent = count;
      badge.classList.remove('hide');
    } else {
      badge.classList.add('hide');
    }
  });
}
// Show New Entertainment Chat
function showEntertainmentChat() {
  hideAll();
  document.getElementById('entertainmentPage').classList.remove('hide');
  loadEntertainmentMessages();
}

// Load Messages (real-time)
function loadEntertainmentMessages() {
  const container = document.getElementById('entChatContainer');
  container.innerHTML = '<p style="text-align:center; opacity:0.7; padding:40px;">Loading chat...</p>';
  
  db.ref('entertainmentChat').orderByChild('timestamp').on('value', snap => {
    container.innerHTML = '';
    
    if (!snap.val()) {
      container.innerHTML = '<p style="text-align:center; opacity:0.7; padding:60px;">Be the first to chat! 🎉</p>';
      return;
    }
    
    snap.forEach(msgSnap => {
      const m = msgSnap.val();
      const isOwn = m.uid === currentUser.uid;
      
      const div = document.createElement('div');
      div.className = `ent-msg ${isOwn ? 'own' : 'other'}`;
      
      let content = m.image ?
        `<img src="${m.image}" alt="Shared image" />` :
        `<div class="ent-msg-text">${m.message || ''}</div>`;
      
      div.innerHTML = `
        <div class="ent-msg-header">
          <img src="${m.photoURL || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(m.username || 'User') + '&background=7b2cff&color=fff&size=128'}" class="ent-msg-pic" />
          <div class="ent-msg-username">${m.username || 'User'}</div>
        </div>
        ${content}
        <div class="ent-msg-time">${new Date(m.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
      `;
      
      container.appendChild(div);
    });
    
    // Auto scroll to bottom
    container.scrollTop = container.scrollHeight;
  });
}

// Send Text Message
function sendEntMessage() {
  const input = document.getElementById('entChatInput');
  const msg = input.value.trim();
  if (!msg) return;
  
  db.ref('users/' + currentUser.uid).once('value').then(snap => {
    const u = snap.val() || {};
    db.ref('entertainmentChat').push({
      uid: currentUser.uid,
      username: u.username || "User",
      photoURL: u.photoURL || "",
      message: msg,
      timestamp: Date.now()
    });
    input.value = "";
  });
}

// Send Image
function sendEntImage(input) {
  const file = input.files[0];
  if (!file || file.size > 5 * 1024 * 1024) {
    alert("Max 5MB image!");
    return;
  }
  
  db.ref('users/' + currentUser.uid).once('value').then(snap => {
    const u = snap.val() || {};
    const ref = storage.ref('ent_images/' + Date.now() + '_' + currentUser.uid);
    ref.put(file).then(() => {
      ref.getDownloadURL().then(url => {
        db.ref('entertainmentChat').push({
          uid: currentUser.uid,
          username: u.username || "User",
          photoURL: u.photoURL || "",
          image: url,
          timestamp: Date.now()
        });
      });
    });
  });
  input.value = "";
}
function showSocialServices() {
  hideAll();
  document.getElementById('socialServicesPage').classList.remove('hide');
  switchTab('services');
  loadBalance();
}

function switchTab(tab) {
  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  document.querySelector(`.tab-btn[onclick="switchTab('${tab}')"]`).classList.add('active');
  
  if (tab === 'services') loadServicesSlim();
}

function loadBalance() {
  db.ref('users/' + currentUser.uid + '/balance').on('value', snap => {
    let bal = snap.val() || 0;
    document.getElementById('currentBalance').textContent = `Rs. ${bal.toLocaleString('en-PK')}`;
  });
}

// ====================
// SERVICES SECTION - FRESH JS (Exact Proportion - No Minimum Unit)
// ====================

let currentSvcKey = null;
let currentSvcData = null;

// 1. Services Slim List Load (sirf name + price dikhega)
function loadServicesSlim() {
  const list = document.getElementById('slimServicesList');
  if (!list) return;
  
  list.innerHTML = '<p>Loading services...</p>';
  
  db.ref('socialServices').once('value').then(snap => {
    list.innerHTML = '';
    
    if (!snap.exists()) {
      list.innerHTML = '<p>No services available right now</p>';
      return;
    }
    
    snap.forEach(child => {
      const s = child.val();
      const key = child.key;
      
      const div = document.createElement('div');
      div.className = 'slim-service';
      div.innerHTML = `
        <h4>${s.name || 'Service'}</h4>
        <div class="price">Rs. ${s.price || 165} per 1000</div>
      `;
      div.onclick = () => openServiceOrderForm(key, s);
      list.appendChild(div);
    });
  }).catch(err => {
    list.innerHTML = '<p>Error loading services</p>';
    console.error("Services load error:", err);
  });
}

// 2. Open Order Form
function openServiceOrderForm(key, svc) {
  currentSvcKey = key;
  currentSvcData = svc;
  
  // Hide list, show form
  document.getElementById('slimServicesList').classList.add('hide');
  document.getElementById('serviceOrderForm').classList.remove('hide');
  
  // Fill form data
  document.getElementById('formServiceTitle').textContent = svc.name || 'Service';
  document.getElementById('formServiceDesc').textContent = svc.description || 'No description';
  
  // Reset inputs
  document.getElementById('orderLink').value = '';
  document.getElementById('orderQty').value = '';
  document.getElementById('orderTotal').textContent = '0.00';
}

// 3. Real-time Total Calculate (Exact - Decimal + Round to 2 places)
function calcServiceTotal() {
  const qtyInput = document.getElementById('orderQty');
  const totalSpan = document.getElementById('orderTotal');
  
  let qty = parseInt(qtyInput.value) || 0;
  if (qty < 1) {
    totalSpan.textContent = '0.00';
    return;
  }
  
  // Admin set price per 1000 (fallback 165)
  let ratePer1000 = currentSvcData?.price || 165;
  
  // Exact calculation
  let exact = (qty / 1000) * ratePer1000;
  
  // 2 decimal places (jaise 82.50, 60.23)
  totalSpan.textContent = exact.toFixed(2);
}

// 4. Place Order + Exact Balance Deduct
function placeOrderWithDeduct() {
  const linkInput = document.getElementById('orderLink');
  const qtyInput = document.getElementById('orderQty');
  const totalSpan = document.getElementById('orderTotal');
  
  let link = linkInput.value.trim();
  let qty = parseInt(qtyInput.value) || 0;
  
  if (!link || qty < 1) {
    alert("Video/Post link aur Quantity daalen!");
    return;
  }
  
  let ratePer1000 = currentSvcData?.price || 165;
  let exactTotal = (qty / 1000) * ratePer1000;
  
  if (exactTotal < 0.01) {
    alert("Minimum charge Rs. 0.01 se zyada honi chahiye!");
    return;
  }
  
  // Check balance
  db.ref('users/' + currentUser.uid + '/balance').once('value').then(snap => {
    let currentBal = parseFloat(snap.val()) || 0;
    
    if (currentBal < exactTotal) {
      alert(`Balance kam hai!\nAapke paas: Rs. ${currentBal.toFixed(2)}\nTotal needed: Rs. ${exactTotal.toFixed(2)}\nRecharge karen.`);
      return;
    }
    
    // Deduct exact amount
    db.ref('users/' + currentUser.uid).update({
      balance: currentBal - exactTotal
    }).then(() => {
      // Save order
      db.ref('serviceOrders').push({
        uid: currentUser.uid,
        username: currentUser.displayName || "User",
        serviceKey: currentSvcKey,
        serviceName: currentSvcData.name || "Service",
        link: link,
        quantity: qty,
        totalPrice: exactTotal,
        status: "pending",
        timestamp: Date.now()
      }).then(() => {
        alert(`Order submit ho gaya!\nQty: ${qty}\nTotal: Rs. ${exactTotal.toFixed(2)}\nBalance se kaat liye gaye.`);
        hideOrderForm();
      }).catch(err => {
        alert("Order save error: " + err.message);
      });
    }).catch(err => {
      alert("Balance deduct error: " + err.message);
    });
  }).catch(err => {
    alert("Balance check error: " + err.message);
  });
}

// Back to list
function hideOrderForm() {
  document.getElementById('serviceOrderForm').classList.add('hide');
  document.getElementById('slimServicesList').classList.remove('hide');
}

// Load balance in real-time
function loadBalance() {
  if (!currentUser) return;
  
  db.ref('users/' + currentUser.uid + '/balance').on('value', snap => {
    let bal = parseFloat(snap.val()) || 0;
    document.getElementById('currentBalance').textContent = `Rs. ${bal.toFixed(2)}`;
  });
}
function backToServicesList() {
  document.getElementById('serviceOrderForm').classList.add('hide');
  document.getElementById('slimServicesList').classList.remove('hide');
}
// Show User Movie History Page
function showUserMovieHistory() {
  hideAll();
  document.getElementById('userMovieHistoryPage').classList.remove('hide');
  loadUserMovieHistory();
}

// Load User's Own Movie/Drama History (Real-time, User-Only View)
function loadUserMovieHistory() {
  const list = document.getElementById('userMovieHistoryList');
  list.innerHTML = '<p class="no-history">Loading history...</p>';

  // Query only user's own requests
  db.ref('movieRequests').orderByChild('uid').equalTo(currentUser.uid).on('value', snap => {
    list.innerHTML = "";
    if (!snap.val()) {
      list.innerHTML = '<p class="no-history">No request history yet 📭</p>';
      return;
    }

    const requests = [];
    snap.forEach(child => {
      requests.push({ key: child.key, ...child.val() });
    });
    requests.sort((a, b) => b.timestamp - a.timestamp); // Newest first

    requests.forEach(req => {
      const div = document.createElement('div');
      div.className = 'history-item';

      const time = new Date(req.timestamp).toLocaleString('en-US', {
        year: 'numeric', month: 'short', day: 'numeric',
        hour: '2-digit', minute: '2-digit'
      });

      div.innerHTML = `
        <div class="history-type">${req.type || 'Unknown'}</div>
        <div class="history-name">${req.movieName}</div>
        <div class="history-whatsapp">WhatsApp: ${req.whatsapp}</div>
        <div class="history-time">Requested: ${time}</div>
        <span class="history-status ${req.status || 'pending'}">${(req.status || 'pending').toUpperCase()}</span>
      `;

      list.appendChild(div);
    });
  });
}
function loadEntertainmentChat() {
  const container = document.getElementById('entertainmentContainer');

  db.ref('entertainmentChat').orderByChild('timestamp').on('value', snap => {
    container.innerHTML = "";
    if (!snap.val()) {
      container.innerHTML = `<p style="text-align:center; opacity:0.7; padding:60px; font-size:18px;">Be the first to share something fun! 🎉</p>`;
      return;
    }

    snap.forEach(msgSnap => {
      const m = msgSnap.val();
      const key = msgSnap.key;
      const isOwn = m.uid === currentUser.uid;

      const div = document.createElement('div');
      div.className = `entertainment-msg ${isOwn ? 'own' : ''}`;

      let content = m.image ? `<img src="${m.image}" />` : `<div class="entertainment-msg-text">${m.message}</div>`;

      let reactionsHTML = '';
      const emojis = { heart:'❤️', fire:'🔥', laugh:'😂', wow:'😮', clap:'👏' };
      if (m.reactions) {
        for (const e in emojis) {
          if (m.reactions[e] > 0) {
            reactionsHTML += `<span class="entertainment-reaction" onclick="reactEntertainment('${key}', '${e}')">${emojis[e]} ${m.reactions[e]}</span>`;
          }
        }
      }

      let repliesHTML = '';
      if (m.replies) {
        Object.entries(m.replies).forEach(([rKey, r]) => {
          const replyOwn = r.uid === currentUser.uid;
          let replyContent = r.image ? `<img src="${r.image}" style="max-width:200px; border-radius:12px;" />` : r.message;
          repliesHTML += `<div class="entertainment-reply ${replyOwn ? 'own' : ''}">
            <strong>${r.username || 'User'}:</strong> ${replyContent}
          </div>`;
        });
      }

      div.innerHTML = `
        <div class="entertainment-msg-header">
          <img src="${m.photoURL || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(m.username || 'U') + '&background=7b2cff&color=fff&size=128'}" class="entertainment-msg-pic" />
          <div class="entertainment-msg-username">${m.username || 'User'}</div>
        </div>
        ${content}
        <div class="entertainment-msg-time">${new Date(m.timestamp).toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})}</div>
        <div class="entertainment-reactions">${reactionsHTML}</div>
        <div style="margin-top:10px; font-size:14px; opacity:0.9; cursor:pointer;" onclick="replyEntertainment('${key}')">↩️ Reply</div>
        ${repliesHTML}
      `;

      if (isOwn) {
        div.innerHTML += `<div style="margin-top:12px; text-align:right;">
          <button style="font-size:13px; padding:6px 12px; background:rgba(255,255,255,0.2); border-radius:12px;" onclick="editEntertainmentMsg('${key}', '${(m.message || '').replace(/'/g, "\\'")}')">Edit</button>
          <button style="font-size:13px; padding:6px 12px; background:#ff4444; border-radius:12px; margin-left:8px;" onclick="deleteEntertainmentMsg('${key}')">Delete</button>
        </div>`;
      }

      container.appendChild(div);
    });

    container.scrollTop = container.scrollHeight;
  });
}
// LIVE DATE + TIME + LOCATION CARD
function updateLiveCard() {
const now = new Date();

// Live Date (Islamic Style)
const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
document.getElementById('liveDate').textContent = now.toLocaleDateString('ur-PK', options);

// Live Time
document.getElementById('liveTime').textContent = now.toLocaleTimeString('en-US', {
hour: '2-digit',
minute: '2-digit',
second: '2-digit'
});
}

// Auto Detect Location & City
function getLocation() {
if (navigator.geolocation) {
navigator.geolocation.getCurrentPosition(showCity, showError);
} else {
document.getElementById('cityName').textContent = "Lahore";
}
}

function showCity(position) {
const lat = position.coords.latitude;
const lon = position.coords.longitude;

fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`)
.then(response => response.json())
.then(data => {
const city = data.address.city || data.address.town || data.address.village || "Lahore";
document.getElementById('cityName').textContent = city;
})
.catch(() => {
document.getElementById('cityName').textContent = "Lahore";
});
}

function showError() {
document.getElementById('cityName').textContent = "Lahore";
}

// Start everything
updateLiveCard();
setInterval(updateLiveCard, 1000);
getLocation();
function replyEntertainment(key) {
  entertainmentReplyingTo = key;
  document.getElementById('entertainmentMsg').placeholder = "Replying to a message...";
  document.getElementById('entertainmentMsg').focus();
}

function sendEntertainmentMessage() {
  const input = document.getElementById('entertainmentMsg');
  const msg = input.value.trim();
  if (!msg) return;

  db.ref('users/' + currentUser.uid).once('value').then(snap => {
    const u = snap.val() || {};
    const data = {
      uid: currentUser.uid,
      username: u.username || "User",
      photoURL: u.photoURL || "",
      message: msg,
      timestamp: Date.now(),
      reactions: {}
    };

    if (entertainmentReplyingTo) {
      db.ref('entertainmentChat/' + entertainmentReplyingTo + '/replies').push(data);
      entertainmentReplyingTo = null;
      input.placeholder = "Share something fun...";
    } else {
      db.ref('entertainmentChat').push(data);
    }

    input.value = "";
  });
}

function sendEntertainmentImage(input) {
  const file = input.files[0];
  if (!file || file.size > 5*1024*1024) {
    alert("Max 5MB!");
    return;
  }

  db.ref('users/' + currentUser.uid).once('value').then(snap => {
    const u = snap.val() || {};
    const ref = storage.ref('entertainment_images/' + Date.now());
    ref.put(file).then(() => {
      ref.getDownloadURL().then(url => {
        const data = {
          uid: currentUser.uid,
          username: u.username || "User",
          photoURL: u.photoURL || "",
          image: url,
          timestamp: Date.now(),
          reactions: {}
        };

        if (entertainmentReplyingTo) {
          db.ref('entertainmentChat/' + entertainmentReplyingTo + '/replies').push(data);
          entertainmentReplyingTo = null;
        } else {
          db.ref('entertainmentChat').push(data);
        }

        input.value = "";
      });
    });
  });
}
// Show SIM Details page
function showSimDetailsRequest() {
  hideAll();
  document.getElementById('simDetailsPage').classList.remove('hide');
  
  // Username auto fill
  db.ref('users/' + currentUser.uid).once('value').then(snap => {
    const data = snap.val() || {};
    const name = data.username || currentUser.displayName || "User";
    document.getElementById('simUserName').textContent = name;
  });
  
  // Clear previous inputs & result
  document.getElementById('simQueryInput').value = "";
  document.getElementById('simReason').value = "";
  document.getElementById('simResult').innerHTML = "";
}

// Submit SIM request
function submitSimRequest() {
  const query = document.getElementById('simQueryInput').value.trim();
  const reason = document.getElementById('simReason').value.trim();
  
  if (!query) {
    alert("Number ya CNIC to likho bhai!");
    return;
  }
  
  // Simple validation (basic)
  if (query.length < 5) {
    alert("Itna chhota number/CNIC nahi ho sakta 😅");
    return;
  }
  
  const resultDiv = document.getElementById('simResult');
  resultDiv.innerHTML = "<p style='color:#ffd700;'>Sending request...</p>";
  
  const requestRef = db.ref('simRequests').push();
  
  const data = {
    uid: currentUser.uid,
    username: document.getElementById('simUserName').textContent,
    query: query,
    reason: reason || "No reason provided",
    status: "pending",
    timestamp: Date.now(),
    adminReply: "",
    adminAction: "" // approved / rejected / deleted
  };
  
  requestRef.set(data)
    .then(() => {
      resultDiv.innerHTML = `
        <div style="background:rgba(0,204,136,0.2); padding:15px; border-radius:12px; border-left:4px solid #00cc88;">
          <strong>Request Sent! ✅</strong><br>
          <small>Request ID: ${requestRef.key.slice(-8).toUpperCase()}</small><br><br>
          ✅ Your request has been approved.
📄 Your data will be visible in the SIM Requests History section within the next 30 minutes. Thank you! 😊
        </div>
      `;
    })
    .catch(err => {
      resultDiv.innerHTML = `<p style="color:#ff4444;">Error: ${err.message}</p>`;
    });
}
// Informations Section Functions
function showInformations() {
  hideAll();
  document.getElementById('informationsPage').classList.remove('hide');
  loadInformations();
}

function loadInformations() {
  const list = document.getElementById('infoList');
  list.innerHTML = '<p style="text-align:center; opacity:0.7; padding:40px;">Loading informations...</p>';

  db.ref('informations').orderByChild('timestamp').on('value', snap => {
    list.innerHTML = "";
    if (!snap.val()) {
      list.innerHTML = '<p style="text-align:center; opacity:0.7; padding:40px;">No informations added yet 📭</p>';
      return;
    }

    const infos = [];
    snap.forEach(child => {
      infos.push({ key: child.key, ...child.val() });
    });
    infos.sort((a, b) => b.timestamp - a.timestamp); // Latest first

    let counter = 1;
    infos.forEach(info => {
      const div = document.createElement('div');
      div.className = 'info-item';

      const watchBtn = info.youtubeLink ? 
        `<a href="${info.youtubeLink}" target="_blank" class="watch-btn">Watch Now ▶️</a>` : 
        '<button class="watch-btn" disabled style="background:#aaa;">No Link Available</button>';

      div.innerHTML = `
        <div class="info-number">${counter++}</div>
        <div class="info-title">${info.title || 'No Title'}</div>
        <div class="info-desc">${info.description || 'No Description'}</div>
        <div class="info-upload">Uploaded by: ${info.uploadBy || 'Admin'}</div>
        ${watchBtn}
      `;

      list.appendChild(div);
    });
  });
}
function reactEntertainment(key, emoji) {
  db.ref(`entertainmentChat/${key}/reactions/${emoji}`).transaction(c => (c || 0) + 1);
}

function editEntertainmentMsg(key, old) {
  const newMsg = prompt("Edit message:", old);
  if (newMsg && newMsg !== old) {
    db.ref('entertainmentChat/' + key).update({ message: newMsg });
  }
}

function deleteEntertainmentMsg(key) {
  if (confirm("Delete this message?")) {
    db.ref('entertainmentChat/' + key).remove();
  }
}

function removeImage() {
  selectedFile = null;
  document.getElementById('compImage').value = "";
  document.getElementById('imagePreview').classList.add('hide');
}

function submitComplaint() {
  const desc = document.getElementById('compDesc').value.trim();
  if (!desc) return alert("Please describe your problem!");

  document.getElementById('loadingText').classList.remove('hide');
  document.querySelector('#complaintForm button').disabled = true;

  const complaintRef = db.ref('complaints').push();
  const complaintId = "CMP-" + complaintRef.key.slice(-8).toUpperCase();

  const data = {
    uid: currentUser.uid,
    name: document.getElementById('compName').value,
    email: document.getElementById('compEmail').value,
    description: desc,
    complaintId: complaintId,
    status: "pending",
    mrcrazyteamReply: "",
    timestamp: Date.now()
  };

  if (selectedFile) {
    const storageRef = storage.ref('complaints/' + complaintRef.key);
    storageRef.put(selectedFile).then(() => {
      storageRef.getDownloadURL().then(url => {
        data.screenshot = url;
        saveComplaint(complaintRef, data);
      });
    });
  } else {
    saveComplaint(complaintRef, data);
  }
}

function saveComplaint(ref, data) {
  ref.set(data).then(() => {
    alert(`Complaint submitted!\nComplaint ID: ${data.complaintId}\nSave it for reference check your complaint in complain history!`);
    document.getElementById('loadingText').classList.add('hide');
    document.querySelector('#complaintForm button').disabled = false;
    showSupport();
  });
}

let emergencyLink = "";

function checkNotifications() {
  db.ref('notifications/normal').once('value').then(snap => {
    const data = snap.val();
    if (data && data.active && data.message) {
      document.getElementById('normalMessage').textContent = data.message;
      document.getElementById('normalNotification').classList.remove('hide');
    }
  });

  db.ref('notifications/emergency').once('value').then(snap => {
    const data = snap.val();
    if (data && data.active && data.message && data.link) {
      document.getElementById('emergencyMessage').textContent = data.message;
      emergencyLink = data.link;
      document.getElementById('emergencyNotification').classList.remove('hide');
    }
  });
}

function closeNormalNotification() {
  document.getElementById('normalNotification').classList.add('hide');
}

function closeEmergencyNotification() {
  document.getElementById('emergencyNotification').classList.add('hide');
}

function openEmergencyLink() {
  if (emergencyLink) {
    window.open(emergencyLink, '_blank');
  }
}

function loadComplaints() {
  const list = document.getElementById('complaintsList');
  list.innerHTML = "<p style='text-align:center; opacity:0.7;'>Loading complaints...</p>";
  
  db.ref('complaints').orderByChild('uid').equalTo(currentUser.uid).on('value', snap => {
    list.innerHTML = "";
    if (!snap.val()) {
      list.innerHTML = "<p style='text-align:center; opacity:0.7; padding:40px;'>No complaints yet 😊</p>";
      return;
    }
    
    const complaints = [];
    snap.forEach(child => complaints.push({ key: child.key, ...child.val() }));
    complaints.sort((a, b) => b.timestamp - a.timestamp); // Newest first
    
    complaints.forEach(c => {
      const div = document.createElement('div');
      div.className = "complaint-card"; // New slim card class
      
      const time = new Date(c.timestamp).toLocaleString(); // Full time
      const reply = c.adminReply ?
        `<div class="complaint-reply"><strong>Admin Reply:</strong> ${c.adminReply}</div>` :
        `<div class="complaint-reply none"><i>No reply yet – wait karo! ⏳</i></div>`;
      
      const screenshot = c.screenshot ?
        `<img src="${c.screenshot}" style="max-width:100%; border-radius:12px; margin:10px 0;" alt="Screenshot" />` :
        '';
      
      div.innerHTML = `
        <div class="complaint-id"><strong>ID:</strong> ${c.complaintId || 'CMP-' + c.key.slice(-8)}</div>
        <div class="complaint-time"><strong>Time:</strong> ${time}</div>
        <div class="complaint-issue"><strong>Issue:</strong> ${c.description}</div>
        ${screenshot}
        <div><span class="status ${c.status || 'pending'}">${(c.status || 'pending').toUpperCase()}</span></div>
        ${reply}
      `;
      
      list.appendChild(div);
    });
  });
}
function loadTotalUsers() {
  db.ref('users').on('value', snap => {
    const count = snap.numChildren();
    document.getElementById('totalUsersCount').textContent = count;
  });
}

function loadUpdates() {
  const list = document.getElementById('updatesList');
  list.innerHTML = '<p style="text-align:center; opacity:0.7;">Loading updates...</p>';
  
  db.ref('groupUpdates').orderByChild('timestamp').on('value', snap => {
    list.innerHTML = "";
    if (!snap.val()) {
      list.innerHTML = '<p style="text-align:center; opacity:0.7; padding:30px;">No updates from MrCrazyTeam yet 👀</p>';
      return;
    }
    
    const updates = [];
    snap.forEach(child => {
      updates.push({ key: child.key, ...child.val() });
    });
    
    updates.sort((a, b) => b.timestamp - a.timestamp);
    
    updates.forEach(update => {
      const div = document.createElement('div');
      div.className = "update-card";
      
      const reactions = update.reactions || { heart: 0, laugh: 0, wow: 0, like: 0, dislike: 0 };
      
      div.innerHTML = `
        <div class="update-text">${update.message || ''}</div>
        <div class="update-meta">Posted by MRCRAZYTEAM • ${new Date(update.timestamp).toLocaleString()}</div>
        <div class="reactions">
          <div class="reaction-btn" onclick="reactToUpdate('${update.key}', 'heart')">
            ❤️ <span>${reactions.heart}</span>
          </div>
          <div class="reaction-btn" onclick="reactToUpdate('${update.key}', 'laugh')">
            😂 <span>${reactions.laugh}</span>
          </div>
          <div class="reaction-btn" onclick="reactToUpdate('${update.key}', 'wow')">
            😮 <span>${reactions.wow}</span>
          </div>
          <div class="reaction-btn" onclick="reactToUpdate('${update.key}', 'like')">
            👍 <span>${reactions.like}</span>
          </div>
          <div class="reaction-btn" onclick="reactToUpdate('${update.key}', 'dislike')">
            👎 <span>${reactions.dislike}</span>
          </div>
        </div>
      `;
      
      list.appendChild(div);
    });
  });
}
// Show Share Friends Page
function showShareFriends() {
  hideAll();
  document.getElementById('shareFriendsPage').classList.remove('hide');
  document.getElementById('shareResult').classList.add('hide');
}

// WhatsApp Share
function shareViaWhatsApp() {
  const appLink = "https://mrcrazy7778.netlify.app/";
  const message = `Assalam o Alaikum! 😊\n\nMrCrazyTeam ki zabardast app try karo!\nMovies, Drama, Chat, SIM Details aur bohot kuch free me!\n\nDownload yahan se: ${appLink}\n\n#MrCrazyTeam`;
  
  const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
  window.open(whatsappUrl, '_blank');
  
  showShareMessage("WhatsApp khul gaya! Dost ko bhej do 🚀", "success");
}

// Copy Link to Clipboard
function copyAppLink() {
  const appLink = "https://mrcrazy7778.netlify.app/";
  
  navigator.clipboard.writeText(appLink)
    .then(() => {
      showShareMessage("🔗 Link Copied Successfully! 📋You can now paste it anywhere you need", "success");
    })
    .catch(err => {
      showShareMessage("Copy nahi ho saka 😕 Manually copy kar lo: " + appLink, "error");
      console.error("Clipboard error:", err);
    });
}

// Show temporary message
function showShareMessage(text, type) {
  const result = document.getElementById('shareResult');
  result.textContent = text;
  result.className = `share-result ${type}`;
  result.classList.remove('hide');
  
  // Auto hide after 4 seconds
  setTimeout(() => {
    result.classList.add('hide');
  }, 4000);
}
function reactToUpdate(updateKey, emoji) {
  if (!currentUser) {
    alert("Login karo pehle!");
    return;
  }
  
  const reactionPath = `groupUpdates/${updateKey}/reactions/${emoji}`;
  const userReactionPath = `groupUpdates/${updateKey}/userReactions/${currentUser.uid}`;
  
  db.ref(userReactionPath).once('value').then(snap => {
    if (snap.val() === emoji) {
      db.ref(userReactionPath).remove();
      db.ref(reactionPath).transaction(count => (count || 1) - 1);
    } else {
      db.ref(userReactionPath).set(emoji);
      db.ref(reactionPath).transaction(count => (count || 0) + 1);
      
      if (snap.val()) {
        const oldEmoji = snap.val();
        db.ref(`groupUpdates/${updateKey}/reactions/${oldEmoji}`).transaction(count => (count || 1) - 1);
      }
    }
  });
}

function loadAppsList() {
  const list = document.getElementById('appsList');
  list.innerHTML = '<p style="text-align:center; opacity:0.7;">Loading apps...</p>';
  
  db.ref('apps').orderByChild('timestamp').on('value', snap => {
    list.innerHTML = "";
    
    if (!snap.val()) {
      list.innerHTML = '<p style="text-align:center; opacity:0.7; padding:50px;">No apps available yet</p>';
      return;
    }
    
    const apps = [];
    snap.forEach(child => {
      apps.push({ id: child.key, ...child.val() });
    });
    apps.sort((a, b) => b.timestamp - a.timestamp);
    
    apps.forEach(app => {
      const div = document.createElement('div');
      div.className = "app-box";
      div.onclick = () => showAppDetails(app);
      
      const icon = app.icon || `https://ui-avatars.com/api/?name=${encodeURIComponent(app.name)}&background=7b2cff&color=fff&size=256`;
      
      div.innerHTML = `
        <img src="${icon}" alt="${app.name}">
        <div class="name">${app.name}</div>
        <div class="dev">by ${app.developer || 'MrCrazy'}</div>
      `;
      
      list.appendChild(div);
    });
  });
}
function showDepositFunds() {
  hideAll();
  document.getElementById('depositFundsPage').classList.remove('hide');
  startDepositChat();
}

function startDepositChat() {
  const box = document.getElementById('depositChatBox');
  box.innerHTML = '';
  
  // Auto greeting
  addBotMessage("Hey " + (currentUser.displayName || "User") + "! Welcome to Deposit Funds.");
  setTimeout(() => {
    addBotMessage("Please select deposit method:");
    document.getElementById('depositMethods').classList.remove('hide');
  }, 1500);
}

function addBotMessage(text) {
  const box = document.getElementById('depositChatBox');
  const div = document.createElement('div');
  div.className = 'bot-msg';
  div.textContent = text;
  box.appendChild(div);
  box.scrollTop = box.scrollHeight;
}

function addUserMessage(text) {
  const box = document.getElementById('depositChatBox');
  const div = document.createElement('div');
  div.className = 'user-msg';
  div.textContent = text;
  box.appendChild(div);
  box.scrollTop = box.scrollHeight;
}

function startDeposit(method) {
  document.getElementById('depositMethods').classList.add('hide');
  addUserMessage("I selected " + method.toUpperCase());
  
  if (method === 'jazzcash' || method === 'sadapay') {
    setTimeout(() => {
      addBotMessage("Typing...");
      setTimeout(() => {
        box.innerHTML = box.innerHTML.replace(/Typing.../, '');
        addBotMessage("Account: JazzCash / Bank");
        addBotMessage("Name: Muhammad Naeem");
        addBotMessage("Number: 03257436319");
        addBotMessage("Abhi apne JazzCash ya bank account se fori iss number par paise send karen.");
        addBotMessage("Paise send karne ke baad TID copy kar len ya jis number se send kiya wo number note kar len.");
        
        setTimeout(() => {
          addBotMessage("Paise send kar diye?");
          const btnDiv = document.createElement('div');
          btnDiv.style.textAlign = 'center';
          btnDiv.style.margin = '15px 0';
          btnDiv.innerHTML = `
            <button style="padding:10px 20px; background:#00cc88; color:white; border:none; border-radius:30px; margin:0 10px;" onclick="depositYes('${method}')">Haan, Send Kar Diye</button>
            <button style="padding:10px 20px; background:#ff4444; color:white; border:none; border-radius:30px;" onclick="depositNo()">Nahi Abhi</button>
          `;
          box.appendChild(btnDiv);
          box.scrollTop = box.scrollHeight;
        }, 2000);
      }, 2500);
    }, 1000);
  } else if (method === 'manual') {
    addBotMessage("Manual deposit ke liye yeh form bhar den:");
    addBotMessage("https://docs.google.com/forms/d/e/1FAIpQLScTtQmjBfvYSZS2Dbl-IekrKA7dxIlJQovhyEcHxOZooJynGw/viewform?usp=send_form");
    addBotMessage("Form bharne ke baad hum check kar lenge. Thanks!");
  }
}

function depositYes(method) {
  addUserMessage("Haan, send kar diye");
  addBotMessage("Great! Ab yahan TID ya jis number se paise bheje wo number likh den:");
  
  const inputDiv = document.createElement('div');
  inputDiv.style.margin = '15px 0';
  inputDiv.innerHTML = `
    <input type="text" id="depositTid" placeholder="TID ya Number" style="width:80%; padding:12px; border-radius:10px; border:1px solid var(--ramzan-gold); background:rgba(255,255,255,0.1); color:white;" />
    <button onclick="submitTid('${method}')" style="padding:12px 20px; background:var(--ramzan-gold); color:#0b1f21; border:none; border-radius:10px; margin-left:10px;">Submit</button>
  `;
  document.getElementById('depositChatBox').appendChild(inputDiv);
  document.getElementById('depositChatBox').scrollTop = document.getElementById('depositChatBox').scrollHeight;
}

function depositNo() {
  addUserMessage("Nahi abhi");
  addBotMessage("No problem! Jab send kar len to phir se try karen.");
  setTimeout(() => {
    document.getElementById('depositMethods').classList.remove('hide');
  }, 2000);
}

function submitTid(method) {
  const tid = document.getElementById('depositTid').value.trim();
  if (!tid) return alert("TID ya number likhen!");
  
  addUserMessage(tid);
  addBotMessage("Kitne paise send kiye? (Rs. mein likhen)");
  
  const amountDiv = document.createElement('div');
  amountDiv.style.margin = '15px 0';
  amountDiv.innerHTML = `
    <input type="number" id="depositAmount" placeholder="Amount (Rs.)" min="1" style="width:80%; padding:12px; border-radius:10px; border:1px solid var(--ramzan-gold); background:rgba(255,255,255,0.1); color:white;" />
    <button onclick="submitDepositAmount('${method}', '${tid}')" style="padding:12px 20px; background:var(--ramzan-gold); color:#0b1f21; border:none; border-radius:10px; margin-left:10px;">Submit</button>
  `;
  document.getElementById('depositChatBox').appendChild(amountDiv);
  document.getElementById('depositChatBox').scrollTop = document.getElementById('depositChatBox').scrollHeight;
}

function submitDepositAmount(method, tid) {
  const amount = parseFloat(document.getElementById('depositAmount').value);
  if (isNaN(amount) || amount <= 0) return alert("Valid amount likhen!");
  
  addUserMessage(amount + " Rs.");
  addBotMessage("Aapki request pending mein chali gayi hai.");
  addBotMessage("3 hours ke andar balance add ho jayega InshaAllah. Wait karen.");
  
  // Save request in Firebase
  db.ref('depositRequests').push({
    uid: currentUser.uid,
    username: currentUser.displayName || "User",
    method: method,
    tid: tid,
    amount: amount,
    status: "pending",
    timestamp: Date.now()
  });
  
  // Clear chat after submit
  setTimeout(() => {
    document.getElementById('depositChatBox').innerHTML = '';
    addBotMessage("Thanks for deposit request! Agar aur help chahiye to phir se start karen.");
    document.getElementById('depositMethods').classList.remove('hide');
  }, 4000);
}
// Show SIM History Page
function showSimHistory() {
  hideAll();
  document.getElementById('simHistoryPage').classList.remove('hide');
  loadSimHistory();
}

// Load User's SIM Requests History
function loadSimHistory() {
  const list = document.getElementById('simHistoryList');
  const noHistory = document.getElementById('noSimHistory');
  
  list.innerHTML = '<p style="text-align:center; opacity:0.7;">Loading history...</p>';
  noHistory.classList.add('hide');

  db.ref('simRequests')
    .orderByChild('uid')
    .equalTo(currentUser.uid)
    .on('value', snap => {
      list.innerHTML = "";
      
      if (!snap.val()) {
        noHistory.classList.remove('hide');
        list.innerHTML = "";
        return;
      }

      const requests = [];
      snap.forEach(child => {
        requests.push({ key: child.key, ...child.val() });
      });
      
      // Newest first
      requests.sort((a, b) => b.timestamp - a.timestamp);

      requests.forEach(req => {
        const div = document.createElement('div');
        div.className = 'sim-history-item';

        const time = new Date(req.timestamp).toLocaleString('en-US', {
          year: 'numeric', month: 'short', day: 'numeric',
          hour: '2-digit', minute: '2-digit'
        });

        const statusClass = req.status || 'pending';
        const replyContent = req.adminReply 
          ? `<div class="sim-reply">${req.adminReply}</div>`
          : `<div class="sim-reply none">No reply from admin yet ⏳</div>`;

        div.innerHTML = `
          <div class="sim-query">Query: ${req.query}</div>
          <div class="sim-reason">Reason: ${req.reason}</div>
          <div class="sim-time">Requested on: ${time}</div>
          <span class="sim-status ${statusClass}">${statusClass.toUpperCase()}</span>
          ${replyContent}
        `;

        list.appendChild(div);
      });
    });
}
// Top Admin Banner - Complete JS (Email/UID Custom Support)
let bannerListener = null; // To stop listener on logout

function loadAdminBanner() {
  if (!currentUser) return; // No user, no banner
  
  const banner = document.getElementById('adminBanner');
  const msgEl = document.getElementById('bannerMsg');
  if (!banner || !msgEl) return; // HTML check
  
  // Stop previous listener if exists
  if (bannerListener) bannerListener.off();
  
  // Check if banner was hidden recently
  const hiddenTime = localStorage.getItem('bannerHidden');
  if (hiddenTime && (Date.now() - parseInt(hiddenTime) < 3600000)) { // 1 hour
    banner.classList.add('hide');
    return;
  }
  
  // Real-time listener for banners
  bannerListener = db.ref('adminBanners').orderByChild('timestamp').limitToLast(1).on('value', snap => {
    banner.classList.add('hide'); // Hide first
    if (!snap.val()) return; // No banners
    
    let showBanner = false;
    let bannerMsg = '';
    
    snap.forEach(child => {
      const b = child.val();
      const now = Date.now();
      
      // Expiry check
      if (b.expiry && now > b.expiry) {
        db.ref('adminBanners/' + child.key).remove(); // Auto-delete expired (admin side pe bhi)
        return;
      }
      
      // Target match: all, UID, or email (lowercase for case-insensitive)
      const userEmail = currentUser.email ? currentUser.email.toLowerCase() : '';
      if (b.target === 'all' || b.target === currentUser.uid || b.target.toLowerCase() === userEmail) {
        showBanner = true;
        bannerMsg = b.message;
      }
    });
    
    if (showBanner && bannerMsg) {
      msgEl.textContent = bannerMsg;
      banner.classList.remove('hide');
    }
  });
}

function closeBanner() {
  document.getElementById('adminBanner').classList.add('hide');
  localStorage.setItem('bannerHidden', Date.now()); // Hide for 1 hour
}

// Call on auth change (add this in auth.onAuthStateChanged)
auth.onAuthStateChanged(user => {
  if (user) {
    currentUser = user;
    loadUserData(user);
    showDashboard();
    checkNotifications();
    loadAdminBanner(); // Banner load here
  } else {
    currentUser = null;
    if (bannerListener) bannerListener.off(); // Stop listener on logout
    showLogin();
  }
});

// On page load, check hidden banner
window.addEventListener('load', () => {
  const hiddenTime = localStorage.getItem('bannerHidden');
  if (hiddenTime && (Date.now() - parseInt(hiddenTime) < 3600000)) {
    if (document.getElementById('adminBanner')) {
      document.getElementById('adminBanner').classList.add('hide');
    }
  }
});
function showContact() {
  hideAll();
  document.getElementById('contactPage').classList.remove('hide');
}

function showAppDetails(app) {
  const modal = document.getElementById('appDetailsModal');
  const details = document.getElementById('appDetails');
  
  const icon = app.icon || `https://ui-avatars.com/api/?name=${encodeURIComponent(app.name)}&background=7b2cff&color=fff&size=512`;
  
  details.innerHTML = `
    <img src="${icon}" class="app-detail-icon" alt="${app.name}">
    <div class="app-detail-name">${app.name}</div>
    <div class="app-detail-dev">by ${app.developer || 'MrCrazyTeam'}</div>
    <div class="app-detail-desc">${app.description || 'No description available'}</div>
    <div style="font-size:16px; opacity:0.8; margin:15px 0;">Size: ${app.size || 'Unknown'}</div>
    <a href="${app.downloadLink}" target="_blank" class="download-big-btn">Download Now 📥</a>
  `;
  
  modal.classList.remove('hide');
}

function closeModal() {
  document.getElementById('appDetailsModal').classList.add('hide');
}

window.onclick = function(e) {
  const modal = document.getElementById('appDetailsModal');
  if (e.target === modal) closeModal();
}

function loadPrivateChat() {
  const container = document.getElementById('chatContainer');

  db.ref('livechat').orderByChild('timestamp').on('value', snap => {
    container.innerHTML = "";
    if (!snap.val()) {
      container.innerHTML = "<p style='text-align:center; opacity:0.7; padding:50px;'>No messages yet. Start chatting!</p>";
      return;
    }

    snap.forEach(msgSnap => {
      const m = msgSnap.val();
      const key = msgSnap.key;

      if (m.uid === currentUser.uid || (m.name === "MrCrazyTeam" && m.toUid === currentUser.uid)) {
        const isOwn = m.uid === currentUser.uid;

        const bubble = document.createElement('div');
        bubble.className = `message ${isOwn ? 'user' : 'mrcrazyteam'}`;

        if (m.image) {
          bubble.innerHTML = `<img src="${m.image}" />`;
        } else {
          bubble.innerHTML = m.message || "";
        }

        bubble.innerHTML += `<small>${new Date(m.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</small>`;

        if (isOwn) {
          bubble.innerHTML += `
            <div class="msg-actions">
              <button onclick="editChatMessage('${key}', '${(m.message || '').replace(/'/g, "\\'")}')">Edit</button>
              <button onclick="deleteChatMessage('${key}')">Delete</button>
            </div>
          `;
        }

        container.appendChild(bubble);
      }
    });

    container.scrollTop = container.scrollHeight;
  });
}

let currentRating = 0;

function showFeedback() {
  hideAll();
  document.getElementById('feedbackPage').classList.remove('hide');
  currentRating = 0;
  updateRatingDisplay();
  loadAllFeedbacks();
}

function setRating(rating) {
  currentRating = rating;
  updateRatingDisplay();
}

function updateRatingDisplay() {
  document.querySelectorAll('.star').forEach((star, index) => {
    if (index < currentRating) {
      star.classList.add('active');
    } else {
      star.classList.remove('active');
    }
  });

  const texts = ["", "Poor", "Okay", "Good", "Great", "Excellent!"];
  document.getElementById('ratingText').textContent = texts[currentRating];
}

function submitFeedback() {
  const text = document.getElementById('feedbackText').value.trim();
  if (currentRating === 0) {
    alert("Please give a star rating!");
    return;
  }
  if (!text) {
    alert("Please write your feedback!");
    return;
  }

  const data = {
    rating: currentRating,
    message: text,
    timestamp: Date.now(),
    likes: 0,
    dislikes: 0,
    likedBy: {},
    dislikedBy: {}
  };

  db.ref('feedbacks').push(data).then(() => {
    alert("Thank you for your feedback! 🌟");
    document.getElementById('feedbackText').value = "";
    currentRating = 0;
    updateRatingDisplay();
  });
}

function loadAllFeedbacks() {
  const list = document.getElementById('feedbackList');
  list.innerHTML = '<p style="text-align:center; opacity:0.7;">Loading feedbacks...</p>';

  db.ref('feedbacks').orderByChild('timestamp').on('value', snap => {
    list.innerHTML = "";
    if (!snap.val()) {
      list.innerHTML = '<p style="text-align:center; opacity:0.7; padding:40px;">No feedback yet. Be the first! ✍️</p>';
      return;
    }

    const feedbacks = [];
    snap.forEach(child => feedbacks.push({key: child.key, ...child.val()}));
    feedbacks.sort((a,b) => b.timestamp - a.timestamp);

    feedbacks.forEach(f => {
      const div = document.createElement('div');
      div.className = "feedback-item";

      const stars = '★'.repeat(f.rating) + '☆'.repeat(5 - f.rating);

      const userLiked = f.likedBy && f.likedBy[currentUser.uid];
      const userDisliked = f.dislikedBy && f.dislikedBy[currentUser.uid];

      div.innerHTML = `
        <div class="feedback-stars">${stars}</div>
        <div class="feedback-text">${f.message}</div>
        <div class="feedback-actions">
          <div class="like-btn ${userLiked ? 'liked' : ''}" onclick="toggleLike('${f.key}', true)">
            👍 <span class="like-count">${f.likes || 0}</span>
          </div>
          <div class="dislike-btn ${userDisliked ? 'disliked' : ''}" onclick="toggleLike('${f.key}', false)">
            👎 <span class="dislike-count">${f.dislikes || 0}</span>
          </div>
        </div>
      `;

      list.appendChild(div);
    });
  });
}

function toggleLike(key, isLike) {
  const userPath = `feedbacks/${key}/${isLike ? 'likedBy' : 'dislikedBy'}/${currentUser.uid}`;
  const countPath = `feedbacks/${key}/${isLike ? 'likes' : 'dislikes'}`;
  const oppositePath = `feedbacks/${key}/${isLike ? 'dislikedBy' : 'likedBy'}/${currentUser.uid}`;

  db.ref(userPath).once('value').then(snap => {
    if (snap.val()) {
      db.ref(userPath).remove();
      db.ref(countPath).transaction(c => (c || 1) - 1);
    } else {
      db.ref(userPath).set(true);
      db.ref(countPath).transaction(c => (c || 0) + 1);

      db.ref(oppositePath).remove();
      const oppCount = isLike ? 'dislikes' : 'likes';
      db.ref(`feedbacks/${key}/${oppCount}`).transaction(c => Math.max(0, (c || 1) - 1));
    }
  });
}

function sendChatMessage() {
  const msg = document.getElementById('chatMsg').value.trim();
  if (!msg) return;

  db.ref('livechat').push({
    uid: currentUser.uid,
    name: currentUser.displayName || "User",
    message: msg,
    timestamp: Date.now()
  });

  document.getElementById('chatMsg').value = "";
}

function editChatMessage(key, oldMsg) {
  const newMsg = prompt("Edit your message:", oldMsg);
  if (newMsg && newMsg !== oldMsg) {
    db.ref('livechat/' + key).update({ message: newMsg });
  }
}

function deleteChatMessage(key) {
  if (confirm("Delete your message?")) {
    db.ref('livechat/' + key).remove();
  }
}

function sendChatImage(input) {
  const file = input.files[0];
  if (!file || file.size > 5*1024*1024) return alert("Max 5MB!");
  const ref = storage.ref('chat_images/' + Date.now() + '_' + currentUser.uid);
  ref.put(file).then(() => {
    ref.getDownloadURL().then(url => {
      db.ref('livechat').push({
        uid: currentUser.uid,
        name: currentUser.displayName || "User",
        image: url,
        timestamp: Date.now()
      });
      input.value = "";
    });
  });
}

let currentSelectedApp = null;

function showNeedAppLobby() {
  hideAll();
  document.getElementById('needAppLobby').classList.remove('hide');
  loadNeedApps();
}

function loadNeedApps() {
  const grid = document.getElementById('needAppsGrid');
  grid.innerHTML = '<p style="grid-column:1/-1;text-align:center;opacity:0.7;">Loading apps...</p>';

  db.ref('needAnyApp').on('value', snap => {
    grid.innerHTML = "";

    if (!snap.val()) {
      grid.innerHTML = '<p style="grid-column:1/-1;text-align:center;opacity:0.7;padding:60px;">No apps listed yet</p>';
      return;
    }

    snap.forEach(child => {
      const app = child.val();
      const div = document.createElement('div');
      div.className = "need-app-box";
      div.onclick = () => openAppDetailDashboard(app);
      div.innerHTML = `
        <div class="icon">${app.icon || '📱'}</div>
        <div class="name">${app.name}</div>
      `;
      grid.appendChild(div);
    });
  });
}

function openAppDetailDashboard(app) {
  currentSelectedApp = app;

  hideAll();
  document.getElementById('appDetailDashboard').classList.remove('hide');
  document.getElementById('detailAppName').textContent = app.name;
  document.getElementById('detailIcon').textContent = app.icon || '📱';
  document.getElementById('detailDescription').textContent = app.description || 'App will be sent on WhatsApp';
  document.getElementById('successMsg').classList.add('hide');
}

function backToNeedAppLobby() {
  showNeedAppLobby();
}

function sendWhatsAppRequest() {
  const number = document.getElementById('whatsappInput').value.trim();

  if (!number || number.length !== 11 || !number.startsWith('03')) {
    alert("Valid 11-digit WhatsApp number daalen (03XXXXXXXXX)");
    return;
  }

  db.ref('appRequests').push({
    appName: currentSelectedApp.name,
    whatsapp: number,
    username: currentUser.displayName || "User",
    uid: currentUser.uid,
    timestamp: Date.now(),
    status: "pending"
  }).then(() => {
    document.getElementById('whatsappInput').value = "";
    document.getElementById('successMsg').classList.remove('hide');
  });
}
</script>
</body>
</html>